Using the `WAND_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
2022-04-19 15:42:01 [WARNING] Process rank: -1, device: cpu, n_gpu: 0distributed training: False, 16-bits training: False
2022-04-19 15:42:01 [INFO] Training/evaluation parameters TrainingArguments(
_n_gpu=0,
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
bf16=False,
bf16_full_eval=False,
data_seed=None,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_pin_memory=True,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
debug=[],
deepspeed=None,
disable_tqdm=False,
do_eval=True,
do_predict=False,
do_train=True,
eval_accumulation_steps=None,
eval_delay=0,
eval_steps=None,
evaluation_strategy=IntervalStrategy.NO,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
gradient_accumulation_steps=1,
gradient_checkpointing=False,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_model_id=None,
hub_strategy=HubStrategy.EVERY_SAVE,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=5e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=-1,
log_level=-1,
log_level_replica=-1,
log_on_each_node=True,
logging_dir=./tmp/test/runs/Apr19_15-42-01_mlt-clx128,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=500,
logging_strategy=IntervalStrategy.STEPS,
lr_scheduler_type=SchedulerType.LINEAR,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
no_cuda=False,
num_train_epochs=3.0,
optim=OptimizerNames.ADAMW_HF,
output_dir=./tmp/test,
overwrite_output_dir=True,
past_index=-1,
per_device_eval_batch_size=8,
per_device_train_batch_size=8,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
remove_unused_columns=True,
report_to=['tensorboard'],
resume_from_checkpoint=None,
run_name=./tmp/test,
save_on_each_node=False,
save_steps=500,
save_strategy=IntervalStrategy.STEPS,
save_total_limit=None,
seed=42,
sharded_ddp=[],
skip_memory_metrics=True,
tf32=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_legacy_prediction_loop=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
xpu_backend=None,
)
2022-04-19 15:42:08 [INFO] Loading Dataset Infos from /home2/xinhe/.cache/huggingface/modules/datasets_modules/datasets/swag/9640de08cdba6a1469ed3834fcab4b8ad8e38caf5d1ba5e7436d8b1fd067ad4c
2022-04-19 15:42:08 [INFO] Overwrite dataset info from restored data version.
2022-04-19 15:42:08 [INFO] Loading Dataset info from /home2/xinhe/.cache/huggingface/datasets/swag/regular/0.0.0/9640de08cdba6a1469ed3834fcab4b8ad8e38caf5d1ba5e7436d8b1fd067ad4c
2022-04-19 15:42:08 [WARNING] Reusing dataset swag (/home2/xinhe/.cache/huggingface/datasets/swag/regular/0.0.0/9640de08cdba6a1469ed3834fcab4b8ad8e38caf5d1ba5e7436d8b1fd067ad4c)
2022-04-19 15:42:08 [INFO] Loading Dataset info from /home2/xinhe/.cache/huggingface/datasets/swag/regular/0.0.0/9640de08cdba6a1469ed3834fcab4b8ad8e38caf5d1ba5e7436d8b1fd067ad4c
  0%|          | 0/3 [00:00<?, ?it/s]100%|██████████| 3/3 [00:00<00:00, 545.26it/s]
[INFO|configuration_utils.py:654] 2022-04-19 15:42:10,414 >> loading configuration file https://huggingface.co/thyagosme/bert-base-uncased-finetuned-swag/resolve/main/config.json from cache at /home2/xinhe/.cache/huggingface/transformers/8ea9dfc816d292e657e00ec68d99a3904f10b1c5277e34025eebbd5981d8239f.d288531b8e1daed3b43562dc0b564339755fcc4b6571dd6c94fe302896124874
[INFO|configuration_utils.py:690] 2022-04-19 15:42:10,415 >> Model config BertConfig {
  "_name_or_path": "thyagosme/bert-base-uncased-finetuned-swag",
  "architectures": [
    "BertForMultipleChoice"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "torch_dtype": "float32",
  "transformers_version": "4.18.0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 30522
}

[INFO|tokenization_utils_base.py:1778] 2022-04-19 15:42:21,329 >> loading file https://huggingface.co/thyagosme/bert-base-uncased-finetuned-swag/resolve/main/vocab.txt from cache at /home2/xinhe/.cache/huggingface/transformers/35a4e48e2c922285e69a574448b0c2d87fca2eaa4f2b8213881a11150d04d82e.d789d64ebfe299b0e416afc4a169632f903f693095b4629a7ea271d5a0cf2c99
[INFO|tokenization_utils_base.py:1778] 2022-04-19 15:42:21,329 >> loading file https://huggingface.co/thyagosme/bert-base-uncased-finetuned-swag/resolve/main/tokenizer.json from cache at /home2/xinhe/.cache/huggingface/transformers/91cead3b0328a2104e1a1f9d1ab04454e3adab916cbed35f26ec1b83e5e1a90b.dc959811ea11b2d6187ac0420d44495e87ec17ecbb8e7f7a767d38155d6b95e9
[INFO|tokenization_utils_base.py:1778] 2022-04-19 15:42:21,329 >> loading file https://huggingface.co/thyagosme/bert-base-uncased-finetuned-swag/resolve/main/added_tokens.json from cache at None
[INFO|tokenization_utils_base.py:1778] 2022-04-19 15:42:21,329 >> loading file https://huggingface.co/thyagosme/bert-base-uncased-finetuned-swag/resolve/main/special_tokens_map.json from cache at /home2/xinhe/.cache/huggingface/transformers/66e309ec9ec9d7cca4d38c994210cd09a41e2021a2be0b6ea16482521e96547e.dd8bd9bfd3664b530ea4e645105f557769387b3da9f79bdb55ed556bdd80611d
[INFO|tokenization_utils_base.py:1778] 2022-04-19 15:42:21,329 >> loading file https://huggingface.co/thyagosme/bert-base-uncased-finetuned-swag/resolve/main/tokenizer_config.json from cache at /home2/xinhe/.cache/huggingface/transformers/68643f0433e788c1ca19b18ef2cfcfc16ab8b738cf24bdf16a987d558128d199.59407384618422b5f582b6046df91db98a0f921d6c959dc7b1f50000ffea1032
[INFO|modeling_utils.py:1772] 2022-04-19 15:42:23,302 >> loading weights file https://huggingface.co/thyagosme/bert-base-uncased-finetuned-swag/resolve/main/pytorch_model.bin from cache at /home2/xinhe/.cache/huggingface/transformers/e235bff5b3acde11d392fa72405ec1d9edb341cdc9c21c4bf061ccbdcb5f0a1c.c69354243407ce3836ab38c7aa1ac7c0d77167b6d41777f1822c43a91df475bb
[INFO|modeling_utils.py:2057] 2022-04-19 15:42:24,179 >> All model checkpoint weights were used when initializing BertForMultipleChoice.

[INFO|modeling_utils.py:2065] 2022-04-19 15:42:24,179 >> All the weights of BertForMultipleChoice were initialized from the model checkpoint at thyagosme/bert-base-uncased-finetuned-swag.
If your task is similar to the task the model of the checkpoint was trained on, you can already use BertForMultipleChoice for predictions without further training.
2022-04-19 15:42:24 [WARNING] Loading cached processed dataset at /home2/xinhe/.cache/huggingface/datasets/swag/regular/0.0.0/9640de08cdba6a1469ed3834fcab4b8ad8e38caf5d1ba5e7436d8b1fd067ad4c/cache-8f9bd7e5b97bf8c8.arrow
2022-04-19 15:42:24 [WARNING] Loading cached processed dataset at /home2/xinhe/.cache/huggingface/datasets/swag/regular/0.0.0/9640de08cdba6a1469ed3834fcab4b8ad8e38caf5d1ba5e7436d8b1fd067ad4c/cache-9bbadb2556c0e8f9.arrow
[INFO|configuration_utils.py:441] 2022-04-19 15:42:25,376 >> Configuration saved in ./tmp/test/config.json
2022-04-19 15:42:25 [INFO] Saving model checkpoint to ./tmp/test
[INFO|configuration_utils.py:441] 2022-04-19 15:42:25,399 >> Configuration saved in ./tmp/test/config.json
[INFO|modeling_utils.py:1378] 2022-04-19 15:42:29,986 >> Model weights saved in ./tmp/test/pytorch_model.bin
[INFO|tokenization_utils_base.py:2086] 2022-04-19 15:42:29,988 >> tokenizer config file saved in ./tmp/test/tokenizer_config.json
[INFO|tokenization_utils_base.py:2092] 2022-04-19 15:42:29,989 >> Special tokens file saved in ./tmp/test/special_tokens_map.json
[INFO|configuration_utils.py:441] 2022-04-19 15:42:30,038 >> Configuration saved in ./tmp/test/config.json
2022-04-19 15:42:30 [INFO] The following columns in the training set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
2022-04-19 15:42:30 [INFO] Pass query framework capability elapsed time: 323.57 ms
2022-04-19 15:42:30 [INFO] Get FP32 model baseline.
2022-04-19 15:42:30 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:42:30,437 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:42:30,438 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:42:30,438 >>   Batch size = 8
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 14.19it/s] 31%|███       | 4/13 [00:00<00:01,  7.54it/s] 38%|███▊      | 5/13 [00:00<00:01,  6.33it/s] 46%|████▌     | 6/13 [00:00<00:01,  5.61it/s] 54%|█████▍    | 7/13 [00:01<00:01,  5.82it/s] 62%|██████▏   | 8/13 [00:01<00:00,  5.39it/s] 69%|██████▉   | 9/13 [00:01<00:00,  4.73it/s] 77%|███████▋  | 10/13 [00:01<00:00,  5.00it/s] 85%|████████▍ | 11/13 [00:01<00:00,  5.06it/s] 92%|█████████▏| 12/13 [00:02<00:00,  4.49it/s]100%|██████████| 13/13 [00:02<00:00,  5.56it/s]
2022-04-19 15:42:32 [INFO] {
2022-04-19 15:42:32 [INFO]     'eval_loss': 1.161203384399414,
2022-04-19 15:42:32 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:42:32 [INFO]     'eval_runtime': 2.5472,
2022-04-19 15:42:32 [INFO]     'eval_samples_per_second': 39.258,
2022-04-19 15:42:32 [INFO]     'eval_steps_per_second': 5.104
2022-04-19 15:42:32 [INFO] }
2022-04-19 15:42:32 [INFO] metric: 0.7699999809265137
2022-04-19 15:42:32 [INFO] Throughput: 39.258 samples/sec
2022-04-19 15:42:32 [INFO] FP32 baseline is: 0.7699999809265137
2022-04-19 15:42:33 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:42:33 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym_float placeholder
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): QuantizedEmbedding(num_embeddings=30522, embedding_dim=768, dtype=torch.quint8, qscheme=torch.per_channel_affine_float_qparams)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:42:38 [INFO] |*******Mixed Precision Statistics*******|
2022-04-19 15:42:38 [INFO] +--------------+---------+-------+-------+
2022-04-19 15:42:38 [INFO] |   Op Type    |  Total  |  INT8 |  FP32 |
2022-04-19 15:42:38 [INFO] +--------------+---------+-------+-------+
2022-04-19 15:42:38 [INFO] |  Embedding   |    3    |   1   |   2   |
2022-04-19 15:42:38 [INFO] |  LayerNorm   |    25   |   0   |   25  |
2022-04-19 15:42:38 [INFO] |    Linear    |    74   |   0   |   74  |
2022-04-19 15:42:38 [INFO] +--------------+---------+-------+-------+
2022-04-19 15:42:38 [INFO] Pass quantize model elapsed time: 5238.53 ms
2022-04-19 15:42:38 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:42:38,239 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:42:38,240 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:42:38,240 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.60it/s] 31%|███       | 4/13 [00:00<00:00, 10.35it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.58it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.47it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.09it/s] 69%|██████▉   | 9/13 [00:01<00:00,  6.88it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.08it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.14it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.64it/s]100%|██████████| 13/13 [00:01<00:00,  7.93it/s]
2022-04-19 15:42:40 [INFO] {
2022-04-19 15:42:40 [INFO]     'eval_loss': 1.1618314981460571,
2022-04-19 15:42:40 [INFO]     'eval_accuracy': 0.7599999904632568,
2022-04-19 15:42:40 [INFO]     'eval_runtime': 1.7797,
2022-04-19 15:42:40 [INFO]     'eval_samples_per_second': 56.19,
2022-04-19 15:42:40 [INFO]     'eval_steps_per_second': 7.305
2022-04-19 15:42:40 [INFO] }
2022-04-19 15:42:40 [INFO] metric: 0.7599999904632568
2022-04-19 15:42:40 [INFO] Throughput: 56.19 samples/sec
2022-04-19 15:42:40 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:42:40 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym_float placeholder
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): QuantizedEmbedding(num_embeddings=512, embedding_dim=768, dtype=torch.quint8, qscheme=torch.per_channel_affine_float_qparams)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:42:42 [INFO] |*******Mixed Precision Statistics*******|
2022-04-19 15:42:42 [INFO] +--------------+---------+-------+-------+
2022-04-19 15:42:42 [INFO] |   Op Type    |  Total  |  INT8 |  FP32 |
2022-04-19 15:42:42 [INFO] +--------------+---------+-------+-------+
2022-04-19 15:42:42 [INFO] |  Embedding   |    3    |   1   |   2   |
2022-04-19 15:42:42 [INFO] |  LayerNorm   |    25   |   0   |   25  |
2022-04-19 15:42:42 [INFO] |    Linear    |    74   |   0   |   74  |
2022-04-19 15:42:42 [INFO] +--------------+---------+-------+-------+
2022-04-19 15:42:42 [INFO] Pass quantize model elapsed time: 2815.75 ms
2022-04-19 15:42:42 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:42:42,842 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:42:42,842 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:42:42,842 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.56it/s] 31%|███       | 4/13 [00:00<00:00, 10.27it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.42it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.32it/s] 62%|██████▏   | 8/13 [00:00<00:00,  7.96it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.22it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.28it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.20it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.60it/s]100%|██████████| 13/13 [00:01<00:00,  7.93it/s]
2022-04-19 15:42:44 [INFO] {
2022-04-19 15:42:44 [INFO]     'eval_loss': 1.1618987321853638,
2022-04-19 15:42:44 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:42:44 [INFO]     'eval_runtime': 1.7786,
2022-04-19 15:42:44 [INFO]     'eval_samples_per_second': 56.223,
2022-04-19 15:42:44 [INFO]     'eval_steps_per_second': 7.309
2022-04-19 15:42:44 [INFO] }
2022-04-19 15:42:44 [INFO] metric: 0.7699999809265137
2022-04-19 15:42:44 [INFO] Throughput: 56.223 samples/sec
2022-04-19 15:42:44 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:42:44 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym_float placeholder
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): QuantizedEmbedding(num_embeddings=2, embedding_dim=768, dtype=torch.quint8, qscheme=torch.per_channel_affine_float_qparams)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:42:47 [INFO] |*******Mixed Precision Statistics*******|
2022-04-19 15:42:47 [INFO] +--------------+---------+-------+-------+
2022-04-19 15:42:47 [INFO] |   Op Type    |  Total  |  INT8 |  FP32 |
2022-04-19 15:42:47 [INFO] +--------------+---------+-------+-------+
2022-04-19 15:42:47 [INFO] |  Embedding   |    3    |   1   |   2   |
2022-04-19 15:42:47 [INFO] |  LayerNorm   |    25   |   0   |   25  |
2022-04-19 15:42:47 [INFO] |    Linear    |    74   |   0   |   74  |
2022-04-19 15:42:47 [INFO] +--------------+---------+-------+-------+
2022-04-19 15:42:47 [INFO] Pass quantize model elapsed time: 2760.8 ms
2022-04-19 15:42:47 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:42:47,389 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:42:47,389 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:42:47,389 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 16.13it/s] 31%|███       | 4/13 [00:00<00:00,  9.75it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.13it/s] 54%|█████▍    | 7/13 [00:00<00:00,  7.95it/s] 62%|██████▏   | 8/13 [00:00<00:00,  7.67it/s] 69%|██████▉   | 9/13 [00:01<00:00,  6.44it/s] 77%|███████▋  | 10/13 [00:01<00:00,  6.65it/s] 85%|████████▍ | 11/13 [00:01<00:00,  6.75it/s] 92%|█████████▏| 12/13 [00:01<00:00,  5.92it/s]100%|██████████| 13/13 [00:01<00:00,  7.17it/s]
2022-04-19 15:42:49 [INFO] {
2022-04-19 15:42:49 [INFO]     'eval_loss': 1.172369360923767,
2022-04-19 15:42:49 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:42:49 [INFO]     'eval_runtime': 1.9209,
2022-04-19 15:42:49 [INFO]     'eval_samples_per_second': 52.059,
2022-04-19 15:42:49 [INFO]     'eval_steps_per_second': 6.768
2022-04-19 15:42:49 [INFO] }
2022-04-19 15:42:49 [INFO] metric: 0.7699999809265137
2022-04-19 15:42:49 [INFO] Throughput: 52.059 samples/sec
2022-04-19 15:42:49 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:42:49 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.0417059101164341, zero_point=143, qscheme=torch.per_channel_affine)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)/home2/xinhe/anaconda3/envs/pytorch110_he/lib/python3.8/site-packages/torch/ao/quantization/observer.py:886: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
  src_bin_begin // dst_bin_width, 0, self.dst_nbins - 1
/home2/xinhe/anaconda3/envs/pytorch110_he/lib/python3.8/site-packages/torch/ao/quantization/observer.py:891: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
  src_bin_end // dst_bin_width, 0, self.dst_nbins - 1
2022-04-19 15:42:52 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:42:52 [INFO] +---------------------+-------+------+------+
2022-04-19 15:42:52 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:42:52 [INFO] +---------------------+-------+------+------+
2022-04-19 15:42:52 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:42:52 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:42:52 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:42:52 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:42:52 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:42:52 [INFO] +---------------------+-------+------+------+
2022-04-19 15:42:52 [INFO] Pass quantize model elapsed time: 2996.96 ms
2022-04-19 15:42:52 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:42:52,359 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:42:52,359 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:42:52,359 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.20it/s] 31%|███       | 4/13 [00:00<00:00, 10.17it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.30it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.20it/s] 62%|██████▏   | 8/13 [00:00<00:00,  7.87it/s] 69%|██████▉   | 9/13 [00:01<00:00,  6.71it/s] 77%|███████▋  | 10/13 [00:01<00:00,  6.88it/s] 85%|████████▍ | 11/13 [00:01<00:00,  6.71it/s] 92%|█████████▏| 12/13 [00:01<00:00,  5.88it/s]100%|██████████| 13/13 [00:01<00:00,  7.47it/s]
2022-04-19 15:42:54 [INFO] {
2022-04-19 15:42:54 [INFO]     'eval_loss': 1.1590595245361328,
2022-04-19 15:42:54 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:42:54 [INFO]     'eval_runtime': 1.8978,
2022-04-19 15:42:54 [INFO]     'eval_samples_per_second': 52.693,
2022-04-19 15:42:54 [INFO]     'eval_steps_per_second': 6.85
2022-04-19 15:42:54 [INFO] }
2022-04-19 15:42:54 [INFO] metric: 0.7699999809265137
2022-04-19 15:42:54 [INFO] Throughput: 52.693 samples/sec
2022-04-19 15:42:54 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:42:54 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.053547896444797516, zero_point=118, qscheme=torch.per_channel_affine)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:42:57 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:42:57 [INFO] +---------------------+-------+------+------+
2022-04-19 15:42:57 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:42:57 [INFO] +---------------------+-------+------+------+
2022-04-19 15:42:57 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:42:57 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:42:57 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:42:57 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:42:57 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:42:57 [INFO] +---------------------+-------+------+------+
2022-04-19 15:42:57 [INFO] Pass quantize model elapsed time: 3253.84 ms
2022-04-19 15:42:57 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:42:57,520 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:42:57,520 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:42:57,520 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.27it/s] 31%|███       | 4/13 [00:00<00:00, 10.10it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.49it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.34it/s] 62%|██████▏   | 8/13 [00:00<00:00,  7.99it/s] 69%|██████▉   | 9/13 [00:01<00:00,  6.77it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.01it/s] 85%|████████▍ | 11/13 [00:01<00:00,  6.95it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.07it/s]100%|██████████| 13/13 [00:01<00:00,  7.62it/s]
2022-04-19 15:42:59 [INFO] {
2022-04-19 15:42:59 [INFO]     'eval_loss': 1.1595149040222168,
2022-04-19 15:42:59 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:42:59 [INFO]     'eval_runtime': 1.8612,
2022-04-19 15:42:59 [INFO]     'eval_samples_per_second': 53.728,
2022-04-19 15:42:59 [INFO]     'eval_steps_per_second': 6.985
2022-04-19 15:42:59 [INFO] }
2022-04-19 15:42:59 [INFO] metric: 0.7699999809265137
2022-04-19 15:42:59 [INFO] Throughput: 53.728 samples/sec
2022-04-19 15:42:59 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:42:59 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.02239888161420822, zero_point=133, qscheme=torch.per_channel_affine)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:43:02 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:43:02 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:02 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:43:02 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:02 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:43:02 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:43:02 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:43:02 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:43:02 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:43:02 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:02 [INFO] Pass quantize model elapsed time: 3019.93 ms
2022-04-19 15:43:02 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:43:02,411 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:43:02,411 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:43:02,411 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.86it/s] 31%|███       | 4/13 [00:00<00:00, 10.50it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.65it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.50it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.14it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.41it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.40it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.34it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.74it/s]100%|██████████| 13/13 [00:01<00:00,  8.10it/s]
2022-04-19 15:43:04 [INFO] {
2022-04-19 15:43:04 [INFO]     'eval_loss': 1.1638981103897095,
2022-04-19 15:43:04 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:43:04 [INFO]     'eval_runtime': 1.7403,
2022-04-19 15:43:04 [INFO]     'eval_samples_per_second': 57.463,
2022-04-19 15:43:04 [INFO]     'eval_steps_per_second': 7.47
2022-04-19 15:43:04 [INFO] }
2022-04-19 15:43:04 [INFO] metric: 0.7699999809265137
2022-04-19 15:43:04 [INFO] Throughput: 57.463 samples/sec
2022-04-19 15:43:04 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:43:04 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): QuantizedLinear(in_features=768, out_features=768, scale=0.03352298215031624, zero_point=182, qscheme=torch.per_channel_affine)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:43:06 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:43:06 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:06 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:43:06 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:06 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:43:06 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:43:06 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:43:06 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:43:06 [INFO] |     input_tensor    |   1   |  1   |  0   |
2022-04-19 15:43:06 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:43:06 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:06 [INFO] Pass quantize model elapsed time: 2696.88 ms
2022-04-19 15:43:06 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:43:06,856 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:43:06,856 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:43:06,856 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.94it/s] 31%|███       | 4/13 [00:00<00:00, 10.54it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.75it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.61it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.22it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.52it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.39it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.37it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.74it/s]100%|██████████| 13/13 [00:01<00:00,  8.13it/s]
2022-04-19 15:43:08 [INFO] {
2022-04-19 15:43:08 [INFO]     'eval_loss': 1.1590715646743774,
2022-04-19 15:43:08 [INFO]     'eval_accuracy': 0.7799999713897705,
2022-04-19 15:43:08 [INFO]     'eval_runtime': 1.7336,
2022-04-19 15:43:08 [INFO]     'eval_samples_per_second': 57.684,
2022-04-19 15:43:08 [INFO]     'eval_steps_per_second': 7.499
2022-04-19 15:43:08 [INFO] }
2022-04-19 15:43:08 [INFO] metric: 0.7799999713897705
2022-04-19 15:43:08 [INFO] Throughput: 57.684 samples/sec
2022-04-19 15:43:08 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:43:08 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): QuantizedLinear(in_features=768, out_features=3072, scale=0.08919712156057358, zero_point=151, qscheme=torch.per_channel_affine)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:43:11 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:43:11 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:11 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:43:11 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:11 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:43:11 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:43:11 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:43:11 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:43:11 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:43:11 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:11 [INFO] Pass quantize model elapsed time: 2787.49 ms
2022-04-19 15:43:11 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:43:11,384 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:43:11,384 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:43:11,384 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.76it/s] 31%|███       | 4/13 [00:00<00:00, 10.59it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.79it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.63it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.21it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.54it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.61it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.53it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.99it/s]100%|██████████| 13/13 [00:01<00:00,  8.26it/s]
2022-04-19 15:43:13 [INFO] {
2022-04-19 15:43:13 [INFO]     'eval_loss': 1.1603672504425049,
2022-04-19 15:43:13 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:43:13 [INFO]     'eval_runtime': 1.7111,
2022-04-19 15:43:13 [INFO]     'eval_samples_per_second': 58.441,
2022-04-19 15:43:13 [INFO]     'eval_steps_per_second': 7.597
2022-04-19 15:43:13 [INFO] }
2022-04-19 15:43:13 [INFO] metric: 0.7699999809265137
2022-04-19 15:43:13 [INFO] Throughput: 58.441 samples/sec
2022-04-19 15:43:13 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:43:13 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): QuantizedLinear(in_features=3072, out_features=768, scale=0.22379988431930542, zero_point=202, qscheme=torch.per_channel_affine)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:43:15 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:43:15 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:15 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:43:15 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:15 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:43:15 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:43:15 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:43:15 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:43:15 [INFO] |     input_tensor    |   1   |  1   |  0   |
2022-04-19 15:43:15 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:43:15 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:15 [INFO] Pass quantize model elapsed time: 2852.24 ms
2022-04-19 15:43:15 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:43:15,956 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:43:15,956 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:43:15,956 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.22it/s] 31%|███       | 4/13 [00:00<00:00, 10.50it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.80it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.67it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.29it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.62it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.67it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.59it/s] 92%|█████████▏| 12/13 [00:01<00:00,  7.02it/s]100%|██████████| 13/13 [00:01<00:00,  8.32it/s]
2022-04-19 15:43:17 [INFO] {
2022-04-19 15:43:17 [INFO]     'eval_loss': 1.1543234586715698,
2022-04-19 15:43:17 [INFO]     'eval_accuracy': 0.7599999904632568,
2022-04-19 15:43:17 [INFO]     'eval_runtime': 1.6952,
2022-04-19 15:43:17 [INFO]     'eval_samples_per_second': 58.989,
2022-04-19 15:43:17 [INFO]     'eval_steps_per_second': 7.669
2022-04-19 15:43:17 [INFO] }
2022-04-19 15:43:17 [INFO] metric: 0.7599999904632568
2022-04-19 15:43:17 [INFO] Throughput: 58.989 samples/sec
2022-04-19 15:43:17 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:43:17 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.046956196427345276, zero_point=121, qscheme=torch.per_channel_affine)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:43:20 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:43:20 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:20 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:43:20 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:20 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:43:20 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:43:20 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:43:20 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:43:20 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:43:20 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:20 [INFO] Pass quantize model elapsed time: 2979.74 ms
2022-04-19 15:43:20 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:43:20,638 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:43:20,638 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:43:20,638 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 16.23it/s] 31%|███       | 4/13 [00:00<00:00, 10.18it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.58it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.46it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.10it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.37it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.40it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.35it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.75it/s]100%|██████████| 13/13 [00:01<00:00,  8.05it/s]
2022-04-19 15:43:22 [INFO] {
2022-04-19 15:43:22 [INFO]     'eval_loss': 1.1637113094329834,
2022-04-19 15:43:22 [INFO]     'eval_accuracy': 0.7599999904632568,
2022-04-19 15:43:22 [INFO]     'eval_runtime': 1.7513,
2022-04-19 15:43:22 [INFO]     'eval_samples_per_second': 57.099,
2022-04-19 15:43:22 [INFO]     'eval_steps_per_second': 7.423
2022-04-19 15:43:22 [INFO] }
2022-04-19 15:43:22 [INFO] metric: 0.7599999904632568
2022-04-19 15:43:22 [INFO] Throughput: 57.099 samples/sec
2022-04-19 15:43:22 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:43:22 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.044569432735443115, zero_point=131, qscheme=torch.per_channel_affine)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:43:24 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:43:24 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:24 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:43:24 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:24 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:43:24 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:43:24 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:43:25 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:43:25 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:43:25 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:25 [INFO] Pass quantize model elapsed time: 2606.96 ms
2022-04-19 15:43:25 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:43:25,003 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:43:25,003 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:43:25,003 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.90it/s] 31%|███       | 4/13 [00:00<00:00, 10.51it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.69it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.56it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.16it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.51it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.54it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.42it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.88it/s]100%|██████████| 13/13 [00:01<00:00,  8.20it/s]
2022-04-19 15:43:26 [INFO] {
2022-04-19 15:43:26 [INFO]     'eval_loss': 1.1627367734909058,
2022-04-19 15:43:26 [INFO]     'eval_accuracy': 0.7599999904632568,
2022-04-19 15:43:26 [INFO]     'eval_runtime': 1.7219,
2022-04-19 15:43:26 [INFO]     'eval_samples_per_second': 58.076,
2022-04-19 15:43:26 [INFO]     'eval_steps_per_second': 7.55
2022-04-19 15:43:26 [INFO] }
2022-04-19 15:43:26 [INFO] metric: 0.7599999904632568
2022-04-19 15:43:26 [INFO] Throughput: 58.076 samples/sec
2022-04-19 15:43:26 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:43:26 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.02600400149822235, zero_point=129, qscheme=torch.per_channel_affine)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:43:29 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:43:29 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:29 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:43:29 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:29 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:43:29 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:43:29 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:43:29 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:43:29 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:43:29 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:29 [INFO] Pass quantize model elapsed time: 2748.71 ms
2022-04-19 15:43:29 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:43:29,480 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:43:29,480 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:43:29,480 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.72it/s] 31%|███       | 4/13 [00:00<00:00, 10.48it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.62it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.48it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.09it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.45it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.44it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.38it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.87it/s]100%|██████████| 13/13 [00:01<00:00,  8.15it/s]
2022-04-19 15:43:31 [INFO] {
2022-04-19 15:43:31 [INFO]     'eval_loss': 1.1604238748550415,
2022-04-19 15:43:31 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:43:31 [INFO]     'eval_runtime': 1.7332,
2022-04-19 15:43:31 [INFO]     'eval_samples_per_second': 57.696,
2022-04-19 15:43:31 [INFO]     'eval_steps_per_second': 7.5
2022-04-19 15:43:31 [INFO] }
2022-04-19 15:43:31 [INFO] metric: 0.7699999809265137
2022-04-19 15:43:31 [INFO] Throughput: 57.696 samples/sec
2022-04-19 15:43:31 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:43:31 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): QuantizedLinear(in_features=768, out_features=768, scale=0.0172349214553833, zero_point=134, qscheme=torch.per_channel_affine)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:43:34 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:43:34 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:34 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:43:34 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:34 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:43:34 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:43:34 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:43:34 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:43:34 [INFO] |     input_tensor    |   1   |  1   |  0   |
2022-04-19 15:43:34 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:43:34 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:34 [INFO] Pass quantize model elapsed time: 2903.4 ms
2022-04-19 15:43:34 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:43:34,125 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:43:34,125 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:43:34,125 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.66it/s] 31%|███       | 4/13 [00:00<00:00, 10.51it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.67it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.52it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.12it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.47it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.53it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.44it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.89it/s]100%|██████████| 13/13 [00:01<00:00,  8.19it/s]
2022-04-19 15:43:35 [INFO] {
2022-04-19 15:43:35 [INFO]     'eval_loss': 1.1622955799102783,
2022-04-19 15:43:35 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:43:35 [INFO]     'eval_runtime': 1.724,
2022-04-19 15:43:35 [INFO]     'eval_samples_per_second': 58.003,
2022-04-19 15:43:35 [INFO]     'eval_steps_per_second': 7.54
2022-04-19 15:43:35 [INFO] }
2022-04-19 15:43:35 [INFO] metric: 0.7699999809265137
2022-04-19 15:43:35 [INFO] Throughput: 58.003 samples/sec
2022-04-19 15:43:35 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:43:36 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): QuantizedLinear(in_features=768, out_features=3072, scale=0.0960511639714241, zero_point=173, qscheme=torch.per_channel_affine)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:43:39 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:43:39 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:39 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:43:39 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:39 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:43:39 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:43:39 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:43:39 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:43:39 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:43:39 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:39 [INFO] Pass quantize model elapsed time: 3340.64 ms
2022-04-19 15:43:39 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:43:39,197 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:43:39,197 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:43:39,197 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.99it/s] 31%|███       | 4/13 [00:00<00:00, 10.41it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.70it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.59it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.19it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.48it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.55it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.47it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.80it/s]100%|██████████| 13/13 [00:01<00:00,  8.18it/s]
2022-04-19 15:43:40 [INFO] {
2022-04-19 15:43:40 [INFO]     'eval_loss': 1.1595125198364258,
2022-04-19 15:43:40 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:43:40 [INFO]     'eval_runtime': 1.7258,
2022-04-19 15:43:40 [INFO]     'eval_samples_per_second': 57.945,
2022-04-19 15:43:40 [INFO]     'eval_steps_per_second': 7.533
2022-04-19 15:43:40 [INFO] }
2022-04-19 15:43:40 [INFO] metric: 0.7699999809265137
2022-04-19 15:43:40 [INFO] Throughput: 57.945 samples/sec
2022-04-19 15:43:40 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:43:41 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): QuantizedLinear(in_features=3072, out_features=768, scale=0.15641142427921295, zero_point=223, qscheme=torch.per_channel_affine)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:43:43 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:43:43 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:43 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:43:43 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:43 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:43:43 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:43:43 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:43:43 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:43:43 [INFO] |     input_tensor    |   1   |  1   |  0   |
2022-04-19 15:43:43 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:43:43 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:43 [INFO] Pass quantize model elapsed time: 2616.98 ms
2022-04-19 15:43:43 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:43:43,547 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:43:43,547 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:43:43,547 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 18.20it/s] 31%|███       | 4/13 [00:00<00:00, 10.73it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.78it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.37it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.80it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.81it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.69it/s] 92%|█████████▏| 12/13 [00:01<00:00,  7.15it/s]100%|██████████| 13/13 [00:01<00:00,  8.35it/s]
2022-04-19 15:43:45 [INFO] {
2022-04-19 15:43:45 [INFO]     'eval_loss': 1.1587754487991333,
2022-04-19 15:43:45 [INFO]     'eval_accuracy': 0.75,
2022-04-19 15:43:45 [INFO]     'eval_runtime': 1.6901,
2022-04-19 15:43:45 [INFO]     'eval_samples_per_second': 59.167,
2022-04-19 15:43:45 [INFO]     'eval_steps_per_second': 7.692
2022-04-19 15:43:45 [INFO] }
2022-04-19 15:43:45 [INFO] metric: 0.75
2022-04-19 15:43:45 [INFO] Throughput: 59.167 samples/sec
2022-04-19 15:43:45 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:43:45 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.05611984431743622, zero_point=129, qscheme=torch.per_channel_affine)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:43:47 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:43:47 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:47 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:43:47 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:47 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:43:47 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:43:47 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:43:47 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:43:47 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:43:47 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:47 [INFO] Pass quantize model elapsed time: 2742.18 ms
2022-04-19 15:43:47 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:43:47,986 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:43:47,986 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:43:47,986 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.54it/s] 31%|███       | 4/13 [00:00<00:00, 10.42it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.64it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.42it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.04it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.39it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.43it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.35it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.83it/s]100%|██████████| 13/13 [00:01<00:00,  8.12it/s]
2022-04-19 15:43:49 [INFO] {
2022-04-19 15:43:49 [INFO]     'eval_loss': 1.1549984216690063,
2022-04-19 15:43:49 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:43:49 [INFO]     'eval_runtime': 1.7393,
2022-04-19 15:43:49 [INFO]     'eval_samples_per_second': 57.493,
2022-04-19 15:43:49 [INFO]     'eval_steps_per_second': 7.474
2022-04-19 15:43:49 [INFO] }
2022-04-19 15:43:49 [INFO] metric: 0.7699999809265137
2022-04-19 15:43:49 [INFO] Throughput: 57.493 samples/sec
2022-04-19 15:43:49 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:43:49 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.05367015674710274, zero_point=130, qscheme=torch.per_channel_affine)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:43:52 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:43:52 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:52 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:43:52 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:52 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:43:52 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:43:52 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:43:52 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:43:52 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:43:52 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:52 [INFO] Pass quantize model elapsed time: 2878.43 ms
2022-04-19 15:43:52 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:43:52,611 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:43:52,611 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:43:52,611 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.71it/s] 31%|███       | 4/13 [00:00<00:00, 10.49it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.68it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.54it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.10it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.43it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.48it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.40it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.82it/s]100%|██████████| 13/13 [00:01<00:00,  8.15it/s]
2022-04-19 15:43:54 [INFO] {
2022-04-19 15:43:54 [INFO]     'eval_loss': 1.1630827188491821,
2022-04-19 15:43:54 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:43:54 [INFO]     'eval_runtime': 1.7321,
2022-04-19 15:43:54 [INFO]     'eval_samples_per_second': 57.732,
2022-04-19 15:43:54 [INFO]     'eval_steps_per_second': 7.505
2022-04-19 15:43:54 [INFO] }
2022-04-19 15:43:54 [INFO] metric: 0.7699999809265137
2022-04-19 15:43:54 [INFO] Throughput: 57.732 samples/sec
2022-04-19 15:43:54 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:43:54 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.03233524411916733, zero_point=116, qscheme=torch.per_channel_affine)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:43:57 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:43:57 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:57 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:43:57 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:57 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:43:57 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:43:57 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:43:57 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:43:57 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:43:57 [INFO] +---------------------+-------+------+------+
2022-04-19 15:43:57 [INFO] Pass quantize model elapsed time: 3013.36 ms
2022-04-19 15:43:57 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:43:57,363 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:43:57,363 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:43:57,363 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.26it/s] 31%|███       | 4/13 [00:00<00:00, 10.29it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.59it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.41it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.03it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.40it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.44it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.38it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.79it/s]100%|██████████| 13/13 [00:01<00:00,  8.08it/s]
2022-04-19 15:43:59 [INFO] {
2022-04-19 15:43:59 [INFO]     'eval_loss': 1.1615372896194458,
2022-04-19 15:43:59 [INFO]     'eval_accuracy': 0.7599999904632568,
2022-04-19 15:43:59 [INFO]     'eval_runtime': 1.7457,
2022-04-19 15:43:59 [INFO]     'eval_samples_per_second': 57.283,
2022-04-19 15:43:59 [INFO]     'eval_steps_per_second': 7.447
2022-04-19 15:43:59 [INFO] }
2022-04-19 15:43:59 [INFO] metric: 0.7599999904632568
2022-04-19 15:43:59 [INFO] Throughput: 57.283 samples/sec
2022-04-19 15:43:59 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:43:59 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): QuantizedLinear(in_features=768, out_features=768, scale=0.014901748858392239, zero_point=135, qscheme=torch.per_channel_affine)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:44:01 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:44:01 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:01 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:44:01 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:01 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:44:01 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:44:01 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:44:01 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:44:01 [INFO] |     input_tensor    |   1   |  1   |  0   |
2022-04-19 15:44:01 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:44:01 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:01 [INFO] Pass quantize model elapsed time: 2700.41 ms
2022-04-19 15:44:01 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:44:01,816 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:44:01,816 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:44:01,816 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.15it/s] 31%|███       | 4/13 [00:00<00:00, 10.27it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.54it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.36it/s] 62%|██████▏   | 8/13 [00:00<00:00,  7.90it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.30it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.35it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.27it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.77it/s]100%|██████████| 13/13 [00:01<00:00,  8.01it/s]
2022-04-19 15:44:03 [INFO] {
2022-04-19 15:44:03 [INFO]     'eval_loss': 1.1613984107971191,
2022-04-19 15:44:03 [INFO]     'eval_accuracy': 0.7599999904632568,
2022-04-19 15:44:03 [INFO]     'eval_runtime': 1.7613,
2022-04-19 15:44:03 [INFO]     'eval_samples_per_second': 56.778,
2022-04-19 15:44:03 [INFO]     'eval_steps_per_second': 7.381
2022-04-19 15:44:03 [INFO] }
2022-04-19 15:44:03 [INFO] metric: 0.7599999904632568
2022-04-19 15:44:03 [INFO] Throughput: 56.778 samples/sec
2022-04-19 15:44:03 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:44:03 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): QuantizedLinear(in_features=768, out_features=3072, scale=0.3113095462322235, zero_point=83, qscheme=torch.per_channel_affine)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:44:06 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:44:06 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:06 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:44:06 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:06 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:44:06 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:44:06 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:44:06 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:44:06 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:44:06 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:06 [INFO] Pass quantize model elapsed time: 2723.03 ms
2022-04-19 15:44:06 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:44:06,309 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:44:06,309 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:44:06,309 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.91it/s] 31%|███       | 4/13 [00:00<00:00, 10.58it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.73it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.56it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.16it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.41it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.48it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.42it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.89it/s]100%|██████████| 13/13 [00:01<00:00,  8.19it/s]
2022-04-19 15:44:08 [INFO] {
2022-04-19 15:44:08 [INFO]     'eval_loss': 1.1717405319213867,
2022-04-19 15:44:08 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:44:08 [INFO]     'eval_runtime': 1.7231,
2022-04-19 15:44:08 [INFO]     'eval_samples_per_second': 58.035,
2022-04-19 15:44:08 [INFO]     'eval_steps_per_second': 7.545
2022-04-19 15:44:08 [INFO] }
2022-04-19 15:44:08 [INFO] metric: 0.7699999809265137
2022-04-19 15:44:08 [INFO] Throughput: 58.035 samples/sec
2022-04-19 15:44:08 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:44:08 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): QuantizedLinear(in_features=3072, out_features=768, scale=1.0803656578063965, zero_point=249, qscheme=torch.per_channel_affine)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:44:10 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:44:10 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:10 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:44:10 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:10 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:44:10 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:44:10 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:44:10 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:44:10 [INFO] |     input_tensor    |   1   |  1   |  0   |
2022-04-19 15:44:10 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:44:10 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:10 [INFO] Pass quantize model elapsed time: 2771.01 ms
2022-04-19 15:44:10 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:44:10,819 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:44:10,819 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:44:10,819 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 18.04it/s] 31%|███       | 4/13 [00:00<00:00, 10.66it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.86it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.37it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.79it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.72it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.60it/s] 92%|█████████▏| 12/13 [00:01<00:00,  7.07it/s]100%|██████████| 13/13 [00:01<00:00,  8.29it/s]
2022-04-19 15:44:12 [INFO] {
2022-04-19 15:44:12 [INFO]     'eval_loss': 1.1972547769546509,
2022-04-19 15:44:12 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:44:12 [INFO]     'eval_runtime': 1.7057,
2022-04-19 15:44:12 [INFO]     'eval_samples_per_second': 58.626,
2022-04-19 15:44:12 [INFO]     'eval_steps_per_second': 7.621
2022-04-19 15:44:12 [INFO] }
2022-04-19 15:44:12 [INFO] metric: 0.7699999809265137
2022-04-19 15:44:12 [INFO] Throughput: 58.626 samples/sec
2022-04-19 15:44:12 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:44:12 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.048743296414613724, zero_point=133, qscheme=torch.per_channel_affine)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:44:15 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:44:15 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:15 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:44:15 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:15 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:44:15 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:44:15 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:44:15 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:44:15 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:44:15 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:15 [INFO] Pass quantize model elapsed time: 3022.55 ms
2022-04-19 15:44:15 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:44:15,554 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:44:15,554 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:44:15,554 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.37it/s] 31%|███       | 4/13 [00:00<00:00, 10.22it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.50it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.31it/s] 62%|██████▏   | 8/13 [00:00<00:00,  7.95it/s] 69%|██████▉   | 9/13 [00:01<00:00,  6.57it/s] 77%|███████▋  | 10/13 [00:01<00:00,  6.82it/s] 85%|████████▍ | 11/13 [00:01<00:00,  6.91it/s] 92%|█████████▏| 12/13 [00:01<00:00,  5.89it/s]100%|██████████| 13/13 [00:01<00:00,  7.51it/s]
2022-04-19 15:44:17 [INFO] {
2022-04-19 15:44:17 [INFO]     'eval_loss': 1.1634265184402466,
2022-04-19 15:44:17 [INFO]     'eval_accuracy': 0.7599999904632568,
2022-04-19 15:44:17 [INFO]     'eval_runtime': 1.8852,
2022-04-19 15:44:17 [INFO]     'eval_samples_per_second': 53.043,
2022-04-19 15:44:17 [INFO]     'eval_steps_per_second': 6.896
2022-04-19 15:44:17 [INFO] }
2022-04-19 15:44:17 [INFO] metric: 0.7599999904632568
2022-04-19 15:44:17 [INFO] Throughput: 53.043 samples/sec
2022-04-19 15:44:17 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:44:17 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.04595823213458061, zero_point=133, qscheme=torch.per_channel_affine)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:44:20 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:44:20 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:20 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:44:20 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:20 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:44:20 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:44:20 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:44:20 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:44:20 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:44:20 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:20 [INFO] Pass quantize model elapsed time: 2671.73 ms
2022-04-19 15:44:20 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:44:20,118 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:44:20,118 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:44:20,118 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.85it/s] 31%|███       | 4/13 [00:00<00:00, 10.39it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.60it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.50it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.14it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.46it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.40it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.35it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.81it/s]100%|██████████| 13/13 [00:01<00:00,  8.13it/s]
2022-04-19 15:44:21 [INFO] {
2022-04-19 15:44:21 [INFO]     'eval_loss': 1.155204176902771,
2022-04-19 15:44:21 [INFO]     'eval_accuracy': 0.7599999904632568,
2022-04-19 15:44:21 [INFO]     'eval_runtime': 1.7345,
2022-04-19 15:44:21 [INFO]     'eval_samples_per_second': 57.654,
2022-04-19 15:44:21 [INFO]     'eval_steps_per_second': 7.495
2022-04-19 15:44:21 [INFO] }
2022-04-19 15:44:21 [INFO] metric: 0.7599999904632568
2022-04-19 15:44:21 [INFO] Throughput: 57.654 samples/sec
2022-04-19 15:44:21 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:44:22 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.032224416732788086, zero_point=116, qscheme=torch.per_channel_affine)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:44:24 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:44:24 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:24 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:44:24 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:24 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:44:24 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:44:24 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:44:24 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:44:24 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:44:24 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:24 [INFO] Pass quantize model elapsed time: 2845.3 ms
2022-04-19 15:44:24 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:44:24,705 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:44:24,705 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:44:24,705 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.68it/s] 31%|███       | 4/13 [00:00<00:00, 10.47it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.71it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.52it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.10it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.45it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.46it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.29it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.77it/s]100%|██████████| 13/13 [00:01<00:00,  8.12it/s]
2022-04-19 15:44:26 [INFO] {
2022-04-19 15:44:26 [INFO]     'eval_loss': 1.157852053642273,
2022-04-19 15:44:26 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:44:26 [INFO]     'eval_runtime': 1.7396,
2022-04-19 15:44:26 [INFO]     'eval_samples_per_second': 57.485,
2022-04-19 15:44:26 [INFO]     'eval_steps_per_second': 7.473
2022-04-19 15:44:26 [INFO] }
2022-04-19 15:44:26 [INFO] metric: 0.7699999809265137
2022-04-19 15:44:26 [INFO] Throughput: 57.485 samples/sec
2022-04-19 15:44:26 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:44:26 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): QuantizedLinear(in_features=768, out_features=768, scale=0.015870830044150352, zero_point=128, qscheme=torch.per_channel_affine)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:44:29 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:44:29 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:29 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:44:29 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:29 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:44:29 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:44:29 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:44:29 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:44:29 [INFO] |     input_tensor    |   1   |  1   |  0   |
2022-04-19 15:44:29 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:44:29 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:29 [INFO] Pass quantize model elapsed time: 2726.96 ms
2022-04-19 15:44:29 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:44:29,179 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:44:29,179 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:44:29,179 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.79it/s] 31%|███       | 4/13 [00:00<00:00, 10.44it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.70it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.54it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.14it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.50it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.55it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.44it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.82it/s]100%|██████████| 13/13 [00:01<00:00,  8.01it/s]
2022-04-19 15:44:30 [INFO] {
2022-04-19 15:44:30 [INFO]     'eval_loss': 1.1638214588165283,
2022-04-19 15:44:30 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:44:30 [INFO]     'eval_runtime': 1.7331,
2022-04-19 15:44:30 [INFO]     'eval_samples_per_second': 57.701,
2022-04-19 15:44:30 [INFO]     'eval_steps_per_second': 7.501
2022-04-19 15:44:30 [INFO] }
2022-04-19 15:44:30 [INFO] metric: 0.7699999809265137
2022-04-19 15:44:30 [INFO] Throughput: 57.701 samples/sec
2022-04-19 15:44:30 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:44:31 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): QuantizedLinear(in_features=768, out_features=3072, scale=0.16229629516601562, zero_point=172, qscheme=torch.per_channel_affine)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:44:33 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:44:33 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:33 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:44:33 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:33 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:44:33 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:44:33 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:44:33 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:44:33 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:44:33 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:33 [INFO] Pass quantize model elapsed time: 2870.18 ms
2022-04-19 15:44:33 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:44:33,816 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:44:33,816 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:44:33,816 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.91it/s] 31%|███       | 4/13 [00:00<00:00, 10.67it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.88it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.36it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.79it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.81it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.69it/s] 92%|█████████▏| 12/13 [00:01<00:00,  7.08it/s]100%|██████████| 13/13 [00:01<00:00,  8.31it/s]
2022-04-19 15:44:35 [INFO] {
2022-04-19 15:44:35 [INFO]     'eval_loss': 1.138749361038208,
2022-04-19 15:44:35 [INFO]     'eval_accuracy': 0.7599999904632568,
2022-04-19 15:44:35 [INFO]     'eval_runtime': 1.7018,
2022-04-19 15:44:35 [INFO]     'eval_samples_per_second': 58.762,
2022-04-19 15:44:35 [INFO]     'eval_steps_per_second': 7.639
2022-04-19 15:44:35 [INFO] }
2022-04-19 15:44:35 [INFO] metric: 0.7599999904632568
2022-04-19 15:44:35 [INFO] Throughput: 58.762 samples/sec
2022-04-19 15:44:35 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:44:35 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): QuantizedLinear(in_features=3072, out_features=768, scale=0.5136721134185791, zero_point=246, qscheme=torch.per_channel_affine)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:44:38 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:44:38 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:38 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:44:38 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:38 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:44:38 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:44:38 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:44:38 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:44:38 [INFO] |     input_tensor    |   1   |  1   |  0   |
2022-04-19 15:44:38 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:44:38 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:38 [INFO] Pass quantize model elapsed time: 2967.39 ms
2022-04-19 15:44:38 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:44:38,494 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:44:38,494 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:44:38,494 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.75it/s] 31%|███       | 4/13 [00:00<00:00, 10.39it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.66it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.55it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.15it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.48it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.49it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.42it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.77it/s]100%|██████████| 13/13 [00:01<00:00,  8.14it/s]
2022-04-19 15:44:40 [INFO] {
2022-04-19 15:44:40 [INFO]     'eval_loss': 1.1773014068603516,
2022-04-19 15:44:40 [INFO]     'eval_accuracy': 0.75,
2022-04-19 15:44:40 [INFO]     'eval_runtime': 1.739,
2022-04-19 15:44:40 [INFO]     'eval_samples_per_second': 57.506,
2022-04-19 15:44:40 [INFO]     'eval_steps_per_second': 7.476
2022-04-19 15:44:40 [INFO] }
2022-04-19 15:44:40 [INFO] metric: 0.75
2022-04-19 15:44:40 [INFO] Throughput: 57.506 samples/sec
2022-04-19 15:44:40 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:44:40 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.05127818509936333, zero_point=135, qscheme=torch.per_channel_affine)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:44:42 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:44:42 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:42 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:44:42 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:42 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:44:42 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:44:42 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:44:42 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:44:42 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:44:42 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:42 [INFO] Pass quantize model elapsed time: 2693.57 ms
2022-04-19 15:44:42 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:44:42,934 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:44:42,934 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:44:42,934 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.70it/s] 31%|███       | 4/13 [00:00<00:00, 10.25it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.59it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.45it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.06it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.44it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.50it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.42it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.90it/s]100%|██████████| 13/13 [00:01<00:00,  8.15it/s]
2022-04-19 15:44:44 [INFO] {
2022-04-19 15:44:44 [INFO]     'eval_loss': 1.1590043306350708,
2022-04-19 15:44:44 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:44:44 [INFO]     'eval_runtime': 1.732,
2022-04-19 15:44:44 [INFO]     'eval_samples_per_second': 57.736,
2022-04-19 15:44:44 [INFO]     'eval_steps_per_second': 7.506
2022-04-19 15:44:44 [INFO] }
2022-04-19 15:44:44 [INFO] metric: 0.7699999809265137
2022-04-19 15:44:44 [INFO] Throughput: 57.736 samples/sec
2022-04-19 15:44:44 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:44:44 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.04391755163669586, zero_point=134, qscheme=torch.per_channel_affine)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:44:47 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:44:47 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:47 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:44:47 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:47 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:44:47 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:44:47 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:44:47 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:44:47 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:44:47 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:47 [INFO] Pass quantize model elapsed time: 2640.84 ms
2022-04-19 15:44:47 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:44:47,314 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:44:47,314 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:44:47,314 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.49it/s] 31%|███       | 4/13 [00:00<00:00, 10.28it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.46it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.34it/s] 62%|██████▏   | 8/13 [00:00<00:00,  7.97it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.35it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.39it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.31it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.80it/s]100%|██████████| 13/13 [00:01<00:00,  8.05it/s]
2022-04-19 15:44:49 [INFO] {
2022-04-19 15:44:49 [INFO]     'eval_loss': 1.1613036394119263,
2022-04-19 15:44:49 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:44:49 [INFO]     'eval_runtime': 1.7556,
2022-04-19 15:44:49 [INFO]     'eval_samples_per_second': 56.96,
2022-04-19 15:44:49 [INFO]     'eval_steps_per_second': 7.405
2022-04-19 15:44:49 [INFO] }
2022-04-19 15:44:49 [INFO] metric: 0.7699999809265137
2022-04-19 15:44:49 [INFO] Throughput: 56.96 samples/sec
2022-04-19 15:44:49 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:44:49 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.031873688101768494, zero_point=134, qscheme=torch.per_channel_affine)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:44:51 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:44:51 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:51 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:44:51 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:51 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:44:51 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:44:51 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:44:51 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:44:51 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:44:51 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:51 [INFO] Pass quantize model elapsed time: 2788.82 ms
2022-04-19 15:44:51 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:44:51,865 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:44:51,865 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:44:51,865 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.65it/s] 31%|███       | 4/13 [00:00<00:00, 10.44it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.59it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.49it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.09it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.45it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.50it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.40it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.84it/s]100%|██████████| 13/13 [00:01<00:00,  8.14it/s]
2022-04-19 15:44:53 [INFO] {
2022-04-19 15:44:53 [INFO]     'eval_loss': 1.1622068881988525,
2022-04-19 15:44:53 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:44:53 [INFO]     'eval_runtime': 1.7347,
2022-04-19 15:44:53 [INFO]     'eval_samples_per_second': 57.648,
2022-04-19 15:44:53 [INFO]     'eval_steps_per_second': 7.494
2022-04-19 15:44:53 [INFO] }
2022-04-19 15:44:53 [INFO] metric: 0.7699999809265137
2022-04-19 15:44:53 [INFO] Throughput: 57.648 samples/sec
2022-04-19 15:44:53 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:44:53 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): QuantizedLinear(in_features=768, out_features=768, scale=0.018328199163079262, zero_point=130, qscheme=torch.per_channel_affine)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:44:56 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:44:56 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:56 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:44:56 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:56 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:44:56 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:44:56 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:44:56 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:44:56 [INFO] |     input_tensor    |   1   |  1   |  0   |
2022-04-19 15:44:56 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:44:56 [INFO] +---------------------+-------+------+------+
2022-04-19 15:44:56 [INFO] Pass quantize model elapsed time: 3031.25 ms
2022-04-19 15:44:56 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:44:56,638 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:44:56,638 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:44:56,638 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.16it/s] 31%|███       | 4/13 [00:00<00:00, 10.22it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.41it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.24it/s] 62%|██████▏   | 8/13 [00:00<00:00,  7.86it/s] 69%|██████▉   | 9/13 [00:01<00:00,  6.95it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.13it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.15it/s] 92%|█████████▏| 12/13 [00:01<00:00,  5.97it/s]100%|██████████| 13/13 [00:01<00:00,  7.61it/s]
2022-04-19 15:44:58 [INFO] {
2022-04-19 15:44:58 [INFO]     'eval_loss': 1.162903904914856,
2022-04-19 15:44:58 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:44:58 [INFO]     'eval_runtime': 1.8616,
2022-04-19 15:44:58 [INFO]     'eval_samples_per_second': 53.718,
2022-04-19 15:44:58 [INFO]     'eval_steps_per_second': 6.983
2022-04-19 15:44:58 [INFO] }
2022-04-19 15:44:58 [INFO] metric: 0.7699999809265137
2022-04-19 15:44:58 [INFO] Throughput: 53.718 samples/sec
2022-04-19 15:44:58 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:44:58 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): QuantizedLinear(in_features=768, out_features=3072, scale=0.2367171347141266, zero_point=191, qscheme=torch.per_channel_affine)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:45:01 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:45:01 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:01 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:45:01 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:01 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:45:01 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:45:01 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:45:01 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:45:01 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:45:01 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:01 [INFO] Pass quantize model elapsed time: 2786.6 ms
2022-04-19 15:45:01 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:45:01,294 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:45:01,294 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:45:01,294 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.92it/s] 31%|███       | 4/13 [00:00<00:00, 10.49it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.65it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.53it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.18it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.53it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.55it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.47it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.92it/s]100%|██████████| 13/13 [00:01<00:00,  8.22it/s]
2022-04-19 15:45:03 [INFO] {
2022-04-19 15:45:03 [INFO]     'eval_loss': 1.1925636529922485,
2022-04-19 15:45:03 [INFO]     'eval_accuracy': 0.75,
2022-04-19 15:45:03 [INFO]     'eval_runtime': 1.7155,
2022-04-19 15:45:03 [INFO]     'eval_samples_per_second': 58.293,
2022-04-19 15:45:03 [INFO]     'eval_steps_per_second': 7.578
2022-04-19 15:45:03 [INFO] }
2022-04-19 15:45:03 [INFO] metric: 0.75
2022-04-19 15:45:03 [INFO] Throughput: 58.293 samples/sec
2022-04-19 15:45:03 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:45:03 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): QuantizedLinear(in_features=3072, out_features=768, scale=0.4011881947517395, zero_point=240, qscheme=torch.per_channel_affine)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:45:05 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:45:05 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:05 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:45:05 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:05 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:45:05 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:45:05 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:45:05 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:45:05 [INFO] |     input_tensor    |   1   |  1   |  0   |
2022-04-19 15:45:05 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:45:05 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:05 [INFO] Pass quantize model elapsed time: 2700.69 ms
2022-04-19 15:45:05 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:45:05,717 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:45:05,717 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:45:05,717 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.82it/s] 31%|███       | 4/13 [00:00<00:00, 10.52it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.82it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.55it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.18it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.54it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.57it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.51it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.95it/s]100%|██████████| 13/13 [00:01<00:00,  8.25it/s]
2022-04-19 15:45:07 [INFO] {
2022-04-19 15:45:07 [INFO]     'eval_loss': 1.1649223566055298,
2022-04-19 15:45:07 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:45:07 [INFO]     'eval_runtime': 1.7101,
2022-04-19 15:45:07 [INFO]     'eval_samples_per_second': 58.475,
2022-04-19 15:45:07 [INFO]     'eval_steps_per_second': 7.602
2022-04-19 15:45:07 [INFO] }
2022-04-19 15:45:07 [INFO] metric: 0.7699999809265137
2022-04-19 15:45:07 [INFO] Throughput: 58.475 samples/sec
2022-04-19 15:45:07 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:45:07 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.055321309715509415, zero_point=130, qscheme=torch.per_channel_affine)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:45:10 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:45:10 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:10 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:45:10 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:10 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:45:10 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:45:10 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:45:10 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:45:10 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:45:10 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:10 [INFO] Pass quantize model elapsed time: 2751.65 ms
2022-04-19 15:45:10 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:45:10,188 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:45:10,188 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:45:10,188 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.82it/s] 31%|███       | 4/13 [00:00<00:00, 10.35it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.42it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.30it/s] 62%|██████▏   | 8/13 [00:00<00:00,  7.85it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.27it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.32it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.26it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.77it/s]100%|██████████| 13/13 [00:01<00:00,  8.00it/s]
2022-04-19 15:45:11 [INFO] {
2022-04-19 15:45:11 [INFO]     'eval_loss': 1.1643370389938354,
2022-04-19 15:45:11 [INFO]     'eval_accuracy': 0.7599999904632568,
2022-04-19 15:45:11 [INFO]     'eval_runtime': 1.7633,
2022-04-19 15:45:11 [INFO]     'eval_samples_per_second': 56.71,
2022-04-19 15:45:11 [INFO]     'eval_steps_per_second': 7.372
2022-04-19 15:45:11 [INFO] }
2022-04-19 15:45:11 [INFO] metric: 0.7599999904632568
2022-04-19 15:45:11 [INFO] Throughput: 56.71 samples/sec
2022-04-19 15:45:11 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:45:12 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.0498587042093277, zero_point=121, qscheme=torch.per_channel_affine)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:45:14 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:45:14 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:14 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:45:14 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:14 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:45:14 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:45:14 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:45:14 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:45:14 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:45:14 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:14 [INFO] Pass quantize model elapsed time: 2810.24 ms
2022-04-19 15:45:14 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:45:14,769 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:45:14,769 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:45:14,769 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.73it/s] 31%|███       | 4/13 [00:00<00:00, 10.56it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.74it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.56it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.15it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.38it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.45it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.38it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.84it/s]100%|██████████| 13/13 [00:01<00:00,  8.16it/s]
2022-04-19 15:45:16 [INFO] {
2022-04-19 15:45:16 [INFO]     'eval_loss': 1.1622065305709839,
2022-04-19 15:45:16 [INFO]     'eval_accuracy': 0.7599999904632568,
2022-04-19 15:45:16 [INFO]     'eval_runtime': 1.7285,
2022-04-19 15:45:16 [INFO]     'eval_samples_per_second': 57.854,
2022-04-19 15:45:16 [INFO]     'eval_steps_per_second': 7.521
2022-04-19 15:45:16 [INFO] }
2022-04-19 15:45:16 [INFO] metric: 0.7599999904632568
2022-04-19 15:45:16 [INFO] Throughput: 57.854 samples/sec
2022-04-19 15:45:16 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:45:16 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.03139925375580788, zero_point=129, qscheme=torch.per_channel_affine)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:45:19 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:45:19 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:19 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:45:19 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:19 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:45:19 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:45:19 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:45:19 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:45:19 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:45:19 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:19 [INFO] Pass quantize model elapsed time: 2834.5 ms
2022-04-19 15:45:19 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:45:19,339 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:45:19,339 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:45:19,339 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.88it/s] 31%|███       | 4/13 [00:00<00:00, 10.46it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.68it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.50it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.11it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.39it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.47it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.40it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.82it/s]100%|██████████| 13/13 [00:01<00:00,  8.14it/s]
2022-04-19 15:45:21 [INFO] {
2022-04-19 15:45:21 [INFO]     'eval_loss': 1.1488587856292725,
2022-04-19 15:45:21 [INFO]     'eval_accuracy': 0.7799999713897705,
2022-04-19 15:45:21 [INFO]     'eval_runtime': 1.7348,
2022-04-19 15:45:21 [INFO]     'eval_samples_per_second': 57.644,
2022-04-19 15:45:21 [INFO]     'eval_steps_per_second': 7.494
2022-04-19 15:45:21 [INFO] }
2022-04-19 15:45:21 [INFO] metric: 0.7799999713897705
2022-04-19 15:45:21 [INFO] Throughput: 57.644 samples/sec
2022-04-19 15:45:21 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:45:21 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): QuantizedLinear(in_features=768, out_features=768, scale=0.019737739115953445, zero_point=133, qscheme=torch.per_channel_affine)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:45:23 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:45:23 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:23 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:45:23 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:23 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:45:23 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:45:23 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:45:23 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:45:23 [INFO] |     input_tensor    |   1   |  1   |  0   |
2022-04-19 15:45:23 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:45:23 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:23 [INFO] Pass quantize model elapsed time: 2859.36 ms
2022-04-19 15:45:23 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:45:23,940 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:45:23,940 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:45:23,940 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.65it/s] 31%|███       | 4/13 [00:00<00:00, 10.35it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.61it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.47it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.05it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.39it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.37it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.32it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.77it/s]100%|██████████| 13/13 [00:01<00:00,  8.08it/s]
2022-04-19 15:45:25 [INFO] {
2022-04-19 15:45:25 [INFO]     'eval_loss': 1.1634589433670044,
2022-04-19 15:45:25 [INFO]     'eval_accuracy': 0.7599999904632568,
2022-04-19 15:45:25 [INFO]     'eval_runtime': 1.7472,
2022-04-19 15:45:25 [INFO]     'eval_samples_per_second': 57.234,
2022-04-19 15:45:25 [INFO]     'eval_steps_per_second': 7.44
2022-04-19 15:45:25 [INFO] }
2022-04-19 15:45:25 [INFO] metric: 0.7599999904632568
2022-04-19 15:45:25 [INFO] Throughput: 57.234 samples/sec
2022-04-19 15:45:25 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:45:25 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): QuantizedLinear(in_features=768, out_features=3072, scale=0.2233216017484665, zero_point=188, qscheme=torch.per_channel_affine)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:45:28 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:45:28 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:28 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:45:28 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:28 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:45:28 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:45:28 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:45:28 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:45:28 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:45:28 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:28 [INFO] Pass quantize model elapsed time: 2629.17 ms
2022-04-19 15:45:28 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:45:28,324 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:45:28,324 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:45:28,324 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.89it/s] 31%|███       | 4/13 [00:00<00:00, 10.58it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.82it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.62it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.22it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.56it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.60it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.52it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.86it/s]100%|██████████| 13/13 [00:01<00:00,  8.24it/s]
2022-04-19 15:45:30 [INFO] {
2022-04-19 15:45:30 [INFO]     'eval_loss': 1.1380641460418701,
2022-04-19 15:45:30 [INFO]     'eval_accuracy': 0.7599999904632568,
2022-04-19 15:45:30 [INFO]     'eval_runtime': 1.7122,
2022-04-19 15:45:30 [INFO]     'eval_samples_per_second': 58.405,
2022-04-19 15:45:30 [INFO]     'eval_steps_per_second': 7.593
2022-04-19 15:45:30 [INFO] }
2022-04-19 15:45:30 [INFO] metric: 0.7599999904632568
2022-04-19 15:45:30 [INFO] Throughput: 58.405 samples/sec
2022-04-19 15:45:30 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:45:30 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): QuantizedLinear(in_features=3072, out_features=768, scale=0.2905566990375519, zero_point=243, qscheme=torch.per_channel_affine)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:45:32 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:45:32 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:32 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:45:32 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:32 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:45:32 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:45:32 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:45:32 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:45:32 [INFO] |     input_tensor    |   1   |  1   |  0   |
2022-04-19 15:45:32 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:45:32 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:32 [INFO] Pass quantize model elapsed time: 2835.02 ms
2022-04-19 15:45:32 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:45:32,878 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:45:32,878 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:45:32,878 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.82it/s] 31%|███       | 4/13 [00:00<00:00, 10.48it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.72it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.59it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.20it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.53it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.60it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.48it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.87it/s]100%|██████████| 13/13 [00:01<00:00,  8.22it/s]
2022-04-19 15:45:34 [INFO] {
2022-04-19 15:45:34 [INFO]     'eval_loss': 1.1389601230621338,
2022-04-19 15:45:34 [INFO]     'eval_accuracy': 0.7599999904632568,
2022-04-19 15:45:34 [INFO]     'eval_runtime': 1.7229,
2022-04-19 15:45:34 [INFO]     'eval_samples_per_second': 58.042,
2022-04-19 15:45:34 [INFO]     'eval_steps_per_second': 7.545
2022-04-19 15:45:34 [INFO] }
2022-04-19 15:45:34 [INFO] metric: 0.7599999904632568
2022-04-19 15:45:34 [INFO] Throughput: 58.042 samples/sec
2022-04-19 15:45:34 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:45:34 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.0584711991250515, zero_point=131, qscheme=torch.per_channel_affine)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:45:37 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:45:37 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:37 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:45:37 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:37 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:45:37 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:45:37 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:45:37 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:45:37 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:45:37 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:37 [INFO] Pass quantize model elapsed time: 2842.28 ms
2022-04-19 15:45:37 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:45:37,450 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:45:37,450 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:45:37,450 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 16.92it/s] 31%|███       | 4/13 [00:00<00:00, 10.41it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.67it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.51it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.13it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.49it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.54it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.48it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.91it/s]100%|██████████| 13/13 [00:01<00:00,  8.19it/s]
2022-04-19 15:45:39 [INFO] {
2022-04-19 15:45:39 [INFO]     'eval_loss': 1.1626372337341309,
2022-04-19 15:45:39 [INFO]     'eval_accuracy': 0.7599999904632568,
2022-04-19 15:45:39 [INFO]     'eval_runtime': 1.7249,
2022-04-19 15:45:39 [INFO]     'eval_samples_per_second': 57.976,
2022-04-19 15:45:39 [INFO]     'eval_steps_per_second': 7.537
2022-04-19 15:45:39 [INFO] }
2022-04-19 15:45:39 [INFO] metric: 0.7599999904632568
2022-04-19 15:45:39 [INFO] Throughput: 57.976 samples/sec
2022-04-19 15:45:39 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:45:39 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.05234256759285927, zero_point=122, qscheme=torch.per_channel_affine)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:45:42 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:45:42 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:42 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:45:42 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:42 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:45:42 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:45:42 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:45:42 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:45:42 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:45:42 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:42 [INFO] Pass quantize model elapsed time: 3092.61 ms
2022-04-19 15:45:42 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:45:42,276 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:45:42,276 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:45:42,276 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 16.74it/s] 31%|███       | 4/13 [00:00<00:00, 10.14it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.46it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.24it/s] 62%|██████▏   | 8/13 [00:00<00:00,  7.66it/s] 69%|██████▉   | 9/13 [00:01<00:00,  6.59it/s] 77%|███████▋  | 10/13 [00:01<00:00,  6.79it/s] 85%|████████▍ | 11/13 [00:01<00:00,  6.62it/s] 92%|█████████▏| 12/13 [00:01<00:00,  5.89it/s]100%|██████████| 13/13 [00:01<00:00,  7.43it/s]
2022-04-19 15:45:44 [INFO] {
2022-04-19 15:45:44 [INFO]     'eval_loss': 1.1586135625839233,
2022-04-19 15:45:44 [INFO]     'eval_accuracy': 0.7599999904632568,
2022-04-19 15:45:44 [INFO]     'eval_runtime': 1.9032,
2022-04-19 15:45:44 [INFO]     'eval_samples_per_second': 52.542,
2022-04-19 15:45:44 [INFO]     'eval_steps_per_second': 6.831
2022-04-19 15:45:44 [INFO] }
2022-04-19 15:45:44 [INFO] metric: 0.7599999904632568
2022-04-19 15:45:44 [INFO] Throughput: 52.542 samples/sec
2022-04-19 15:45:44 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:45:44 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.033032916486263275, zero_point=127, qscheme=torch.per_channel_affine)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:45:47 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:45:47 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:47 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:45:47 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:47 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:45:47 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:45:47 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:45:47 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:45:47 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:45:47 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:47 [INFO] Pass quantize model elapsed time: 2837.11 ms
2022-04-19 15:45:47 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:45:47,023 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:45:47,023 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:45:47,023 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.66it/s] 31%|███       | 4/13 [00:00<00:00, 10.40it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.66it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.52it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.13it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.47it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.49it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.35it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.78it/s]100%|██████████| 13/13 [00:01<00:00,  8.13it/s]
2022-04-19 15:45:48 [INFO] {
2022-04-19 15:45:48 [INFO]     'eval_loss': 1.1647589206695557,
2022-04-19 15:45:48 [INFO]     'eval_accuracy': 0.7799999713897705,
2022-04-19 15:45:48 [INFO]     'eval_runtime': 1.7367,
2022-04-19 15:45:48 [INFO]     'eval_samples_per_second': 57.58,
2022-04-19 15:45:48 [INFO]     'eval_steps_per_second': 7.485
2022-04-19 15:45:48 [INFO] }
2022-04-19 15:45:48 [INFO] metric: 0.7799999713897705
2022-04-19 15:45:48 [INFO] Throughput: 57.58 samples/sec
2022-04-19 15:45:48 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:45:48 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): QuantizedLinear(in_features=768, out_features=768, scale=0.0182969830930233, zero_point=134, qscheme=torch.per_channel_affine)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:45:51 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:45:51 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:51 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:45:51 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:51 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:45:51 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:45:51 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:45:51 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:45:51 [INFO] |     input_tensor    |   1   |  1   |  0   |
2022-04-19 15:45:51 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:45:51 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:51 [INFO] Pass quantize model elapsed time: 2859.46 ms
2022-04-19 15:45:51 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:45:51,626 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:45:51,626 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:45:51,626 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.56it/s] 31%|███       | 4/13 [00:00<00:00, 10.20it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.45it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.32it/s] 62%|██████▏   | 8/13 [00:00<00:00,  7.95it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.33it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.36it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.22it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.71it/s]100%|██████████| 13/13 [00:01<00:00,  7.98it/s]
2022-04-19 15:45:53 [INFO] {
2022-04-19 15:45:53 [INFO]     'eval_loss': 1.1589738130569458,
2022-04-19 15:45:53 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:45:53 [INFO]     'eval_runtime': 1.7685,
2022-04-19 15:45:53 [INFO]     'eval_samples_per_second': 56.545,
2022-04-19 15:45:53 [INFO]     'eval_steps_per_second': 7.351
2022-04-19 15:45:53 [INFO] }
2022-04-19 15:45:53 [INFO] metric: 0.7699999809265137
2022-04-19 15:45:53 [INFO] Throughput: 56.545 samples/sec
2022-04-19 15:45:53 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:45:53 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): QuantizedLinear(in_features=768, out_features=3072, scale=0.0833163633942604, zero_point=193, qscheme=torch.per_channel_affine)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:45:56 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:45:56 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:56 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:45:56 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:56 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:45:56 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:45:56 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:45:56 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:45:56 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:45:56 [INFO] +---------------------+-------+------+------+
2022-04-19 15:45:56 [INFO] Pass quantize model elapsed time: 2708.53 ms
2022-04-19 15:45:56 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:45:56,110 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:45:56,111 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:45:56,111 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.66it/s] 31%|███       | 4/13 [00:00<00:00, 10.49it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.67it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.52it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.11it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.48it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.51it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.40it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.85it/s]100%|██████████| 13/13 [00:01<00:00,  8.15it/s]
2022-04-19 15:45:57 [INFO] {
2022-04-19 15:45:57 [INFO]     'eval_loss': 1.0188544988632202,
2022-04-19 15:45:57 [INFO]     'eval_accuracy': 0.75,
2022-04-19 15:45:57 [INFO]     'eval_runtime': 1.7357,
2022-04-19 15:45:57 [INFO]     'eval_samples_per_second': 57.614,
2022-04-19 15:45:57 [INFO]     'eval_steps_per_second': 7.49
2022-04-19 15:45:57 [INFO] }
2022-04-19 15:45:57 [INFO] metric: 0.75
2022-04-19 15:45:57 [INFO] Throughput: 57.614 samples/sec
2022-04-19 15:45:57 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:45:58 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): QuantizedLinear(in_features=3072, out_features=768, scale=0.1722712516784668, zero_point=236, qscheme=torch.per_channel_affine)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:46:00 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:46:00 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:00 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:46:00 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:00 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:46:00 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:46:00 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:46:00 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:46:00 [INFO] |     input_tensor    |   1   |  1   |  0   |
2022-04-19 15:46:00 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:46:00 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:00 [INFO] Pass quantize model elapsed time: 2874.27 ms
2022-04-19 15:46:00 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:46:00,727 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:46:00,727 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:46:00,727 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 16.94it/s] 31%|███       | 4/13 [00:00<00:00, 10.44it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.75it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.64it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.24it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.60it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.59it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.48it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.93it/s]100%|██████████| 13/13 [00:01<00:00,  8.25it/s]
2022-04-19 15:46:02 [INFO] {
2022-04-19 15:46:02 [INFO]     'eval_loss': 1.1675249338150024,
2022-04-19 15:46:02 [INFO]     'eval_accuracy': 0.7599999904632568,
2022-04-19 15:46:02 [INFO]     'eval_runtime': 1.7091,
2022-04-19 15:46:02 [INFO]     'eval_samples_per_second': 58.511,
2022-04-19 15:46:02 [INFO]     'eval_steps_per_second': 7.606
2022-04-19 15:46:02 [INFO] }
2022-04-19 15:46:02 [INFO] metric: 0.7599999904632568
2022-04-19 15:46:02 [INFO] Throughput: 58.511 samples/sec
2022-04-19 15:46:02 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:46:02 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.06363168358802795, zero_point=131, qscheme=torch.per_channel_affine)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:46:05 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:46:05 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:05 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:46:05 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:05 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:46:05 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:46:05 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:46:05 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:46:05 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:46:05 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:05 [INFO] Pass quantize model elapsed time: 2911.47 ms
2022-04-19 15:46:05 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:46:05,355 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:46:05,355 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:46:05,355 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.18it/s] 31%|███       | 4/13 [00:00<00:00, 10.32it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.59it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.43it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.06it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.43it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.44it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.35it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.80it/s]100%|██████████| 13/13 [00:01<00:00,  8.09it/s]
2022-04-19 15:46:07 [INFO] {
2022-04-19 15:46:07 [INFO]     'eval_loss': 1.1588433980941772,
2022-04-19 15:46:07 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:46:07 [INFO]     'eval_runtime': 1.7439,
2022-04-19 15:46:07 [INFO]     'eval_samples_per_second': 57.344,
2022-04-19 15:46:07 [INFO]     'eval_steps_per_second': 7.455
2022-04-19 15:46:07 [INFO] }
2022-04-19 15:46:07 [INFO] metric: 0.7699999809265137
2022-04-19 15:46:07 [INFO] Throughput: 57.344 samples/sec
2022-04-19 15:46:07 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:46:07 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.049989160150289536, zero_point=125, qscheme=torch.per_channel_affine)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:46:10 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:46:10 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:10 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:46:10 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:10 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:46:10 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:46:10 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:46:10 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:46:10 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:46:10 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:10 [INFO] Pass quantize model elapsed time: 2964.12 ms
2022-04-19 15:46:10 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:46:10,070 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:46:10,070 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:46:10,070 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 16.79it/s] 31%|███       | 4/13 [00:00<00:00, 10.26it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.49it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.37it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.06it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.41it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.45it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.40it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.77it/s]100%|██████████| 13/13 [00:01<00:00,  8.06it/s]
2022-04-19 15:46:11 [INFO] {
2022-04-19 15:46:11 [INFO]     'eval_loss': 1.1626274585723877,
2022-04-19 15:46:11 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:46:11 [INFO]     'eval_runtime': 1.7495,
2022-04-19 15:46:11 [INFO]     'eval_samples_per_second': 57.16,
2022-04-19 15:46:11 [INFO]     'eval_steps_per_second': 7.431
2022-04-19 15:46:11 [INFO] }
2022-04-19 15:46:11 [INFO] metric: 0.7699999809265137
2022-04-19 15:46:11 [INFO] Throughput: 57.16 samples/sec
2022-04-19 15:46:11 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:46:12 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.027152862399816513, zero_point=121, qscheme=torch.per_channel_affine)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:46:14 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:46:14 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:14 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:46:14 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:14 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:46:14 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:46:14 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:46:14 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:46:14 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:46:14 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:14 [INFO] Pass quantize model elapsed time: 2803.08 ms
2022-04-19 15:46:14 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:46:14,631 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:46:14,631 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:46:14,631 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 15.38it/s] 31%|███       | 4/13 [00:00<00:00,  9.95it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.49it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.37it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.02it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.38it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.42it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.37it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.81it/s]100%|██████████| 13/13 [00:01<00:00,  8.03it/s]
2022-04-19 15:46:16 [INFO] {
2022-04-19 15:46:16 [INFO]     'eval_loss': 1.1601566076278687,
2022-04-19 15:46:16 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:46:16 [INFO]     'eval_runtime': 1.7995,
2022-04-19 15:46:16 [INFO]     'eval_samples_per_second': 55.57,
2022-04-19 15:46:16 [INFO]     'eval_steps_per_second': 7.224
2022-04-19 15:46:16 [INFO] }
2022-04-19 15:46:16 [INFO] metric: 0.7699999809265137
2022-04-19 15:46:16 [INFO] Throughput: 55.57 samples/sec
2022-04-19 15:46:16 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:46:16 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): QuantizedLinear(in_features=768, out_features=768, scale=0.017637671902775764, zero_point=119, qscheme=torch.per_channel_affine)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:46:19 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:46:19 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:19 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:46:19 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:19 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:46:19 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:46:19 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:46:19 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:46:19 [INFO] |     input_tensor    |   1   |  1   |  0   |
2022-04-19 15:46:19 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:46:19 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:19 [INFO] Pass quantize model elapsed time: 2650.19 ms
2022-04-19 15:46:19 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:46:19,089 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:46:19,089 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:46:19,089 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.64it/s] 31%|███       | 4/13 [00:00<00:00, 10.13it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.49it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.37it/s] 62%|██████▏   | 8/13 [00:00<00:00,  7.98it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.37it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.43it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.31it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.80it/s]100%|██████████| 13/13 [00:01<00:00,  8.06it/s]
2022-04-19 15:46:20 [INFO] {
2022-04-19 15:46:20 [INFO]     'eval_loss': 1.1610301733016968,
2022-04-19 15:46:20 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:46:20 [INFO]     'eval_runtime': 1.7526,
2022-04-19 15:46:20 [INFO]     'eval_samples_per_second': 57.058,
2022-04-19 15:46:20 [INFO]     'eval_steps_per_second': 7.418
2022-04-19 15:46:20 [INFO] }
2022-04-19 15:46:20 [INFO] metric: 0.7699999809265137
2022-04-19 15:46:20 [INFO] Throughput: 57.058 samples/sec
2022-04-19 15:46:20 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:46:21 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): QuantizedLinear(in_features=768, out_features=3072, scale=0.07046372443437576, zero_point=173, qscheme=torch.per_channel_affine)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:46:23 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:46:23 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:23 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:46:23 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:23 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:46:23 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:46:23 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:46:23 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:46:23 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:46:23 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:23 [INFO] Pass quantize model elapsed time: 2928.55 ms
2022-04-19 15:46:23 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:46:23,777 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:46:23,777 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:46:23,777 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.74it/s] 31%|███       | 4/13 [00:00<00:00, 10.44it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.70it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.52it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.15it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.53it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.59it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.49it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.94it/s]100%|██████████| 13/13 [00:01<00:00,  8.22it/s]
2022-04-19 15:46:25 [INFO] {
2022-04-19 15:46:25 [INFO]     'eval_loss': 1.1684929132461548,
2022-04-19 15:46:25 [INFO]     'eval_accuracy': 0.7599999904632568,
2022-04-19 15:46:25 [INFO]     'eval_runtime': 1.7169,
2022-04-19 15:46:25 [INFO]     'eval_samples_per_second': 58.245,
2022-04-19 15:46:25 [INFO]     'eval_steps_per_second': 7.572
2022-04-19 15:46:25 [INFO] }
2022-04-19 15:46:25 [INFO] metric: 0.7599999904632568
2022-04-19 15:46:25 [INFO] Throughput: 58.245 samples/sec
2022-04-19 15:46:25 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:46:25 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): QuantizedLinear(in_features=3072, out_features=768, scale=0.08789373934268951, zero_point=220, qscheme=torch.per_channel_affine)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:46:28 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:46:28 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:28 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:46:28 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:28 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:46:28 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:46:28 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:46:28 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:46:28 [INFO] |     input_tensor    |   1   |  1   |  0   |
2022-04-19 15:46:28 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:46:28 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:28 [INFO] Pass quantize model elapsed time: 2983.37 ms
2022-04-19 15:46:28 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:46:28,484 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:46:28,484 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:46:28,484 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 18.06it/s] 31%|███       | 4/13 [00:00<00:00, 10.59it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.84it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.39it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.82it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.82it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.70it/s] 92%|█████████▏| 12/13 [00:01<00:00,  7.13it/s]100%|██████████| 13/13 [00:01<00:00,  8.35it/s]
2022-04-19 15:46:30 [INFO] {
2022-04-19 15:46:30 [INFO]     'eval_loss': 1.1675331592559814,
2022-04-19 15:46:30 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:46:30 [INFO]     'eval_runtime': 1.6894,
2022-04-19 15:46:30 [INFO]     'eval_samples_per_second': 59.193,
2022-04-19 15:46:30 [INFO]     'eval_steps_per_second': 7.695
2022-04-19 15:46:30 [INFO] }
2022-04-19 15:46:30 [INFO] metric: 0.7699999809265137
2022-04-19 15:46:30 [INFO] Throughput: 59.193 samples/sec
2022-04-19 15:46:30 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:46:30 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.05210834741592407, zero_point=133, qscheme=torch.per_channel_affine)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:46:33 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:46:33 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:33 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:46:33 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:33 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:46:33 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:46:33 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:46:33 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:46:33 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:46:33 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:33 [INFO] Pass quantize model elapsed time: 3263.5 ms
2022-04-19 15:46:33 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:46:33,444 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:46:33,444 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:46:33,444 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 16.86it/s] 31%|███       | 4/13 [00:00<00:00, 10.28it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.63it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.50it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.12it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.42it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.44it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.39it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.76it/s]100%|██████████| 13/13 [00:01<00:00,  8.09it/s]
2022-04-19 15:46:35 [INFO] {
2022-04-19 15:46:35 [INFO]     'eval_loss': 1.1624699831008911,
2022-04-19 15:46:35 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:46:35 [INFO]     'eval_runtime': 1.7443,
2022-04-19 15:46:35 [INFO]     'eval_samples_per_second': 57.329,
2022-04-19 15:46:35 [INFO]     'eval_steps_per_second': 7.453
2022-04-19 15:46:35 [INFO] }
2022-04-19 15:46:35 [INFO] metric: 0.7699999809265137
2022-04-19 15:46:35 [INFO] Throughput: 57.329 samples/sec
2022-04-19 15:46:35 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:46:35 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.047590017318725586, zero_point=123, qscheme=torch.per_channel_affine)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:46:37 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:46:37 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:37 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:46:37 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:37 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:46:37 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:46:37 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:46:37 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:46:37 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:46:37 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:37 [INFO] Pass quantize model elapsed time: 2708.64 ms
2022-04-19 15:46:37 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:46:37,904 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:46:37,904 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:46:37,904 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.83it/s] 31%|███       | 4/13 [00:00<00:00, 10.32it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.60it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.45it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.09it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.44it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.50it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.41it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.83it/s]100%|██████████| 13/13 [00:01<00:00,  8.12it/s]
2022-04-19 15:46:39 [INFO] {
2022-04-19 15:46:39 [INFO]     'eval_loss': 1.159474492073059,
2022-04-19 15:46:39 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:46:39 [INFO]     'eval_runtime': 1.737,
2022-04-19 15:46:39 [INFO]     'eval_samples_per_second': 57.569,
2022-04-19 15:46:39 [INFO]     'eval_steps_per_second': 7.484
2022-04-19 15:46:39 [INFO] }
2022-04-19 15:46:39 [INFO] metric: 0.7699999809265137
2022-04-19 15:46:39 [INFO] Throughput: 57.569 samples/sec
2022-04-19 15:46:39 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:46:39 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.03256099671125412, zero_point=135, qscheme=torch.per_channel_affine)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:46:42 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:46:42 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:42 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:46:42 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:42 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:46:42 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:46:42 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:46:42 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:46:42 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:46:42 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:42 [INFO] Pass quantize model elapsed time: 2914.0 ms
2022-04-19 15:46:42 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:46:42,563 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:46:42,563 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:46:42,563 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.60it/s] 31%|███       | 4/13 [00:00<00:00, 10.28it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.58it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.44it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.07it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.47it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.52it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.43it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.88it/s]100%|██████████| 13/13 [00:01<00:00,  8.14it/s]
2022-04-19 15:46:44 [INFO] {
2022-04-19 15:46:44 [INFO]     'eval_loss': 1.165773868560791,
2022-04-19 15:46:44 [INFO]     'eval_accuracy': 0.7599999904632568,
2022-04-19 15:46:44 [INFO]     'eval_runtime': 1.7351,
2022-04-19 15:46:44 [INFO]     'eval_samples_per_second': 57.634,
2022-04-19 15:46:44 [INFO]     'eval_steps_per_second': 7.492
2022-04-19 15:46:44 [INFO] }
2022-04-19 15:46:44 [INFO] metric: 0.7599999904632568
2022-04-19 15:46:44 [INFO] Throughput: 57.634 samples/sec
2022-04-19 15:46:44 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:46:44 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): QuantizedLinear(in_features=768, out_features=768, scale=0.01994420774281025, zero_point=109, qscheme=torch.per_channel_affine)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:46:47 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:46:47 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:47 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:46:47 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:47 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:46:47 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:46:47 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:46:47 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:46:47 [INFO] |     input_tensor    |   1   |  1   |  0   |
2022-04-19 15:46:47 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:46:47 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:47 [INFO] Pass quantize model elapsed time: 2841.01 ms
2022-04-19 15:46:47 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:46:47,147 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:46:47,147 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:46:47,148 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.82it/s] 31%|███       | 4/13 [00:00<00:00, 10.27it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.67it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.52it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.15it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.49it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.51it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.45it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.89it/s]100%|██████████| 13/13 [00:01<00:00,  8.18it/s]
2022-04-19 15:46:48 [INFO] {
2022-04-19 15:46:48 [INFO]     'eval_loss': 1.1616649627685547,
2022-04-19 15:46:48 [INFO]     'eval_accuracy': 0.7599999904632568,
2022-04-19 15:46:48 [INFO]     'eval_runtime': 1.7244,
2022-04-19 15:46:48 [INFO]     'eval_samples_per_second': 57.99,
2022-04-19 15:46:48 [INFO]     'eval_steps_per_second': 7.539
2022-04-19 15:46:48 [INFO] }
2022-04-19 15:46:48 [INFO] metric: 0.7599999904632568
2022-04-19 15:46:48 [INFO] Throughput: 57.99 samples/sec
2022-04-19 15:46:48 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:46:49 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): QuantizedLinear(in_features=768, out_features=3072, scale=0.09602002799510956, zero_point=161, qscheme=torch.per_channel_affine)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:46:51 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:46:51 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:51 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:46:51 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:51 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:46:51 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:46:51 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:46:51 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:46:51 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:46:51 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:51 [INFO] Pass quantize model elapsed time: 3084.67 ms
2022-04-19 15:46:51 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:46:51,964 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:46:51,964 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:46:51,964 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.90it/s] 31%|███       | 4/13 [00:00<00:00, 10.44it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.73it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.61it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.19it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.54it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.58it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.46it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.91it/s]100%|██████████| 13/13 [00:01<00:00,  8.23it/s]
2022-04-19 15:46:53 [INFO] {
2022-04-19 15:46:53 [INFO]     'eval_loss': 1.166690468788147,
2022-04-19 15:46:53 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:46:53 [INFO]     'eval_runtime': 1.7178,
2022-04-19 15:46:53 [INFO]     'eval_samples_per_second': 58.213,
2022-04-19 15:46:53 [INFO]     'eval_steps_per_second': 7.568
2022-04-19 15:46:53 [INFO] }
2022-04-19 15:46:53 [INFO] metric: 0.7699999809265137
2022-04-19 15:46:53 [INFO] Throughput: 58.213 samples/sec
2022-04-19 15:46:53 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:46:53 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): QuantizedLinear(in_features=3072, out_features=768, scale=0.11661391705274582, zero_point=187, qscheme=torch.per_channel_affine)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:46:56 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:46:56 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:56 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:46:56 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:56 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:46:56 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:46:56 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:46:56 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:46:56 [INFO] |     input_tensor    |   1   |  1   |  0   |
2022-04-19 15:46:56 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:46:56 [INFO] +---------------------+-------+------+------+
2022-04-19 15:46:56 [INFO] Pass quantize model elapsed time: 2994.47 ms
2022-04-19 15:46:56 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:46:56,683 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:46:56,683 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:46:56,683 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 16.45it/s] 31%|███       | 4/13 [00:00<00:00, 10.35it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.62it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.51it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.18it/s] 69%|██████▉   | 9/13 [00:01<00:00,  6.96it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.18it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.25it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.80it/s]100%|██████████| 13/13 [00:01<00:00,  8.02it/s]
2022-04-19 15:46:58 [INFO] {
2022-04-19 15:46:58 [INFO]     'eval_loss': 1.176044225692749,
2022-04-19 15:46:58 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:46:58 [INFO]     'eval_runtime': 1.7624,
2022-04-19 15:46:58 [INFO]     'eval_samples_per_second': 56.739,
2022-04-19 15:46:58 [INFO]     'eval_steps_per_second': 7.376
2022-04-19 15:46:58 [INFO] }
2022-04-19 15:46:58 [INFO] metric: 0.7699999809265137
2022-04-19 15:46:58 [INFO] Throughput: 56.739 samples/sec
2022-04-19 15:46:58 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:46:58 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.05423753708600998, zero_point=128, qscheme=torch.per_channel_affine)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:47:01 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:47:01 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:01 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:47:01 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:01 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:47:01 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:47:01 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:47:01 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:47:01 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:47:01 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:01 [INFO] Pass quantize model elapsed time: 2882.04 ms
2022-04-19 15:47:01 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:47:01,335 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:47:01,335 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:47:01,335 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 16.84it/s] 31%|███       | 4/13 [00:00<00:00, 10.27it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.53it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.43it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.08it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.40it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.44it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.37it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.75it/s]100%|██████████| 13/13 [00:01<00:00,  8.06it/s]
2022-04-19 15:47:03 [INFO] {
2022-04-19 15:47:03 [INFO]     'eval_loss': 1.1677857637405396,
2022-04-19 15:47:03 [INFO]     'eval_accuracy': 0.7599999904632568,
2022-04-19 15:47:03 [INFO]     'eval_runtime': 1.7489,
2022-04-19 15:47:03 [INFO]     'eval_samples_per_second': 57.178,
2022-04-19 15:47:03 [INFO]     'eval_steps_per_second': 7.433
2022-04-19 15:47:03 [INFO] }
2022-04-19 15:47:03 [INFO] metric: 0.7599999904632568
2022-04-19 15:47:03 [INFO] Throughput: 57.178 samples/sec
2022-04-19 15:47:03 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:47:03 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.04415325075387955, zero_point=129, qscheme=torch.per_channel_affine)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:47:05 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:47:05 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:05 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:47:05 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:05 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:47:05 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:47:05 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:47:05 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:47:05 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:47:05 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:05 [INFO] Pass quantize model elapsed time: 2751.24 ms
2022-04-19 15:47:05 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:47:05,842 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:47:05,842 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:47:05,842 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.48it/s] 31%|███       | 4/13 [00:00<00:00, 10.22it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.55it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.41it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.02it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.36it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.40it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.32it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.78it/s]100%|██████████| 13/13 [00:01<00:00,  8.05it/s]
2022-04-19 15:47:07 [INFO] {
2022-04-19 15:47:07 [INFO]     'eval_loss': 1.161755084991455,
2022-04-19 15:47:07 [INFO]     'eval_accuracy': 0.7599999904632568,
2022-04-19 15:47:07 [INFO]     'eval_runtime': 1.7525,
2022-04-19 15:47:07 [INFO]     'eval_samples_per_second': 57.06,
2022-04-19 15:47:07 [INFO]     'eval_steps_per_second': 7.418
2022-04-19 15:47:07 [INFO] }
2022-04-19 15:47:07 [INFO] metric: 0.7599999904632568
2022-04-19 15:47:07 [INFO] Throughput: 57.06 samples/sec
2022-04-19 15:47:07 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:47:07 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.03594454750418663, zero_point=125, qscheme=torch.per_channel_affine)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:47:10 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:47:10 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:10 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:47:10 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:10 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:47:10 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:47:10 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:47:10 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:47:10 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:47:10 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:10 [INFO] Pass quantize model elapsed time: 2807.57 ms
2022-04-19 15:47:10 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:47:10,409 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:47:10,409 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:47:10,409 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.72it/s] 31%|███       | 4/13 [00:00<00:00, 10.04it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.51it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.38it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.01it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.38it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.43it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.39it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.80it/s]100%|██████████| 13/13 [00:01<00:00,  8.07it/s]
2022-04-19 15:47:12 [INFO] {
2022-04-19 15:47:12 [INFO]     'eval_loss': 1.1600321531295776,
2022-04-19 15:47:12 [INFO]     'eval_accuracy': 0.7799999713897705,
2022-04-19 15:47:12 [INFO]     'eval_runtime': 1.7488,
2022-04-19 15:47:12 [INFO]     'eval_samples_per_second': 57.182,
2022-04-19 15:47:12 [INFO]     'eval_steps_per_second': 7.434
2022-04-19 15:47:12 [INFO] }
2022-04-19 15:47:12 [INFO] metric: 0.7799999713897705
2022-04-19 15:47:12 [INFO] Throughput: 57.182 samples/sec
2022-04-19 15:47:12 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:47:12 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): QuantizedLinear(in_features=768, out_features=768, scale=0.024771062657237053, zero_point=135, qscheme=torch.per_channel_affine)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:47:15 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:47:15 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:15 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:47:15 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:15 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:47:15 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:47:15 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:47:15 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:47:15 [INFO] |     input_tensor    |   1   |  1   |  0   |
2022-04-19 15:47:15 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:47:15 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:15 [INFO] Pass quantize model elapsed time: 2851.33 ms
2022-04-19 15:47:15 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:47:15,017 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:47:15,017 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:47:15,017 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.58it/s] 31%|███       | 4/13 [00:00<00:00, 10.30it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.57it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.43it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.06it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.44it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.49it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.41it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.87it/s]100%|██████████| 13/13 [00:01<00:00,  8.13it/s]
2022-04-19 15:47:16 [INFO] {
2022-04-19 15:47:16 [INFO]     'eval_loss': 1.1635524034500122,
2022-04-19 15:47:16 [INFO]     'eval_accuracy': 0.7599999904632568,
2022-04-19 15:47:16 [INFO]     'eval_runtime': 1.7352,
2022-04-19 15:47:16 [INFO]     'eval_samples_per_second': 57.631,
2022-04-19 15:47:16 [INFO]     'eval_steps_per_second': 7.492
2022-04-19 15:47:16 [INFO] }
2022-04-19 15:47:16 [INFO] metric: 0.7599999904632568
2022-04-19 15:47:16 [INFO] Throughput: 57.631 samples/sec
2022-04-19 15:47:16 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:47:17 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): QuantizedLinear(in_features=768, out_features=3072, scale=0.27679479122161865, zero_point=113, qscheme=torch.per_channel_affine)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:47:19 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:47:19 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:19 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:47:19 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:19 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:47:19 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:47:19 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:47:19 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:47:19 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:47:19 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:19 [INFO] Pass quantize model elapsed time: 2916.17 ms
2022-04-19 15:47:19 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:47:19,676 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:47:19,677 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:47:19,677 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.91it/s] 31%|███       | 4/13 [00:00<00:00, 10.57it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.70it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.58it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.18it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.54it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.56it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.47it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.93it/s]100%|██████████| 13/13 [00:01<00:00,  8.23it/s]
2022-04-19 15:47:21 [INFO] {
2022-04-19 15:47:21 [INFO]     'eval_loss': 1.1639411449432373,
2022-04-19 15:47:21 [INFO]     'eval_accuracy': 0.7799999713897705,
2022-04-19 15:47:21 [INFO]     'eval_runtime': 1.7145,
2022-04-19 15:47:21 [INFO]     'eval_samples_per_second': 58.327,
2022-04-19 15:47:21 [INFO]     'eval_steps_per_second': 7.583
2022-04-19 15:47:21 [INFO] }
2022-04-19 15:47:21 [INFO] metric: 0.7799999713897705
2022-04-19 15:47:21 [INFO] Throughput: 58.327 samples/sec
2022-04-19 15:47:21 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:47:21 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): QuantizedLinear(in_features=3072, out_features=768, scale=3.7282352447509766, zero_point=163, qscheme=torch.per_channel_affine)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:47:24 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:47:24 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:24 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:47:24 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:24 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:47:24 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:47:24 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:47:24 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:47:24 [INFO] |     input_tensor    |   1   |  1   |  0   |
2022-04-19 15:47:24 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:47:24 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:24 [INFO] Pass quantize model elapsed time: 3196.99 ms
2022-04-19 15:47:24 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:47:24,595 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:47:24,595 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:47:24,595 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.99it/s] 31%|███       | 4/13 [00:00<00:00, 10.33it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.64it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.54it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.17it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.46it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.51it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.46it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.84it/s]100%|██████████| 13/13 [00:01<00:00,  8.18it/s]
2022-04-19 15:47:26 [INFO] {
2022-04-19 15:47:26 [INFO]     'eval_loss': 1.1645389795303345,
2022-04-19 15:47:26 [INFO]     'eval_accuracy': 0.7300000190734863,
2022-04-19 15:47:26 [INFO]     'eval_runtime': 1.7246,
2022-04-19 15:47:26 [INFO]     'eval_samples_per_second': 57.984,
2022-04-19 15:47:26 [INFO]     'eval_steps_per_second': 7.538
2022-04-19 15:47:26 [INFO] }
2022-04-19 15:47:26 [INFO] metric: 0.7300000190734863
2022-04-19 15:47:26 [INFO] Throughput: 57.984 samples/sec
2022-04-19 15:47:26 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:47:26 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.051784105598926544, zero_point=136, qscheme=torch.per_channel_affine)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:47:28 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:47:28 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:28 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:47:28 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:28 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:47:28 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:47:28 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:47:28 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:47:28 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:47:28 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:28 [INFO] Pass quantize model elapsed time: 2620.88 ms
2022-04-19 15:47:28 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:47:28,948 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:47:28,948 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:47:28,948 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.47it/s] 31%|███       | 4/13 [00:00<00:00, 10.37it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.51it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.40it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.04it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.40it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.46it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.35it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.80it/s]100%|██████████| 13/13 [00:01<00:00,  8.08it/s]
2022-04-19 15:47:30 [INFO] {
2022-04-19 15:47:30 [INFO]     'eval_loss': 1.160336971282959,
2022-04-19 15:47:30 [INFO]     'eval_accuracy': 0.7599999904632568,
2022-04-19 15:47:30 [INFO]     'eval_runtime': 1.7453,
2022-04-19 15:47:30 [INFO]     'eval_samples_per_second': 57.296,
2022-04-19 15:47:30 [INFO]     'eval_steps_per_second': 7.448
2022-04-19 15:47:30 [INFO] }
2022-04-19 15:47:30 [INFO] metric: 0.7599999904632568
2022-04-19 15:47:30 [INFO] Throughput: 57.296 samples/sec
2022-04-19 15:47:30 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:47:30 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.05027920752763748, zero_point=120, qscheme=torch.per_channel_affine)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:47:33 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:47:33 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:33 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:47:33 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:33 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:47:33 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:47:33 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:47:33 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:47:33 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:47:33 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:33 [INFO] Pass quantize model elapsed time: 2707.56 ms
2022-04-19 15:47:33 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:47:33,408 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:47:33,408 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:47:33,408 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.57it/s] 31%|███       | 4/13 [00:00<00:00, 10.33it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.59it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.32it/s] 62%|██████▏   | 8/13 [00:00<00:00,  7.99it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.36it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.41it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.34it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.81it/s]100%|██████████| 13/13 [00:01<00:00,  8.07it/s]
2022-04-19 15:47:35 [INFO] {
2022-04-19 15:47:35 [INFO]     'eval_loss': 1.1630836725234985,
2022-04-19 15:47:35 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:47:35 [INFO]     'eval_runtime': 1.7469,
2022-04-19 15:47:35 [INFO]     'eval_samples_per_second': 57.243,
2022-04-19 15:47:35 [INFO]     'eval_steps_per_second': 7.442
2022-04-19 15:47:35 [INFO] }
2022-04-19 15:47:35 [INFO] metric: 0.7699999809265137
2022-04-19 15:47:35 [INFO] Throughput: 57.243 samples/sec
2022-04-19 15:47:35 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:47:35 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.043374478816986084, zero_point=117, qscheme=torch.per_channel_affine)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:47:38 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:47:38 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:38 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:47:38 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:38 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:47:38 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:47:38 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:47:38 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:47:38 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:47:38 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:38 [INFO] Pass quantize model elapsed time: 2897.92 ms
2022-04-19 15:47:38 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:47:38,060 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:47:38,060 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:47:38,060 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.65it/s] 31%|███       | 4/13 [00:00<00:00, 10.46it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.70it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.40it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.05it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.42it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.49it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.39it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.84it/s]100%|██████████| 13/13 [00:01<00:00,  8.13it/s]
2022-04-19 15:47:39 [INFO] {
2022-04-19 15:47:39 [INFO]     'eval_loss': 1.163123607635498,
2022-04-19 15:47:39 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:47:39 [INFO]     'eval_runtime': 1.7339,
2022-04-19 15:47:39 [INFO]     'eval_samples_per_second': 57.673,
2022-04-19 15:47:39 [INFO]     'eval_steps_per_second': 7.498
2022-04-19 15:47:39 [INFO] }
2022-04-19 15:47:39 [INFO] metric: 0.7699999809265137
2022-04-19 15:47:39 [INFO] Throughput: 57.673 samples/sec
2022-04-19 15:47:39 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:47:40 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): QuantizedLinear(in_features=768, out_features=768, scale=0.025812730193138123, zero_point=173, qscheme=torch.per_channel_affine)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:47:42 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:47:42 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:42 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:47:42 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:42 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:47:42 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:47:42 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:47:42 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:47:42 [INFO] |     input_tensor    |   1   |  1   |  0   |
2022-04-19 15:47:42 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:47:42 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:42 [INFO] Pass quantize model elapsed time: 2921.55 ms
2022-04-19 15:47:42 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:47:42,723 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:47:42,723 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:47:42,723 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.91it/s] 31%|███       | 4/13 [00:00<00:00, 10.53it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.76it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.42it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.06it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.44it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.49it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.41it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.86it/s]100%|██████████| 13/13 [00:01<00:00,  8.17it/s]
2022-04-19 15:47:44 [INFO] {
2022-04-19 15:47:44 [INFO]     'eval_loss': 1.16234290599823,
2022-04-19 15:47:44 [INFO]     'eval_accuracy': 0.7599999904632568,
2022-04-19 15:47:44 [INFO]     'eval_runtime': 1.7275,
2022-04-19 15:47:44 [INFO]     'eval_samples_per_second': 57.888,
2022-04-19 15:47:44 [INFO]     'eval_steps_per_second': 7.525
2022-04-19 15:47:44 [INFO] }
2022-04-19 15:47:44 [INFO] metric: 0.7599999904632568
2022-04-19 15:47:44 [INFO] Throughput: 57.888 samples/sec
2022-04-19 15:47:44 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:47:44 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): QuantizedLinear(in_features=768, out_features=3072, scale=0.5172399282455444, zero_point=77, qscheme=torch.per_channel_affine)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:47:47 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:47:47 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:47 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:47:47 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:47 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:47:47 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:47:47 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:47:47 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:47:47 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:47:47 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:47 [INFO] Pass quantize model elapsed time: 3085.86 ms
2022-04-19 15:47:47 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:47:47,543 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:47:47,543 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:47:47,543 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.10it/s] 31%|███       | 4/13 [00:00<00:00, 10.43it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.57it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.47it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.08it/s] 69%|██████▉   | 9/13 [00:01<00:00,  6.90it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.05it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.11it/s] 92%|█████████▏| 12/13 [00:01<00:00,  5.94it/s]100%|██████████| 13/13 [00:01<00:00,  7.64it/s]
2022-04-19 15:47:49 [INFO] {
2022-04-19 15:47:49 [INFO]     'eval_loss': 1.1561030149459839,
2022-04-19 15:47:49 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:47:49 [INFO]     'eval_runtime': 1.8511,
2022-04-19 15:47:49 [INFO]     'eval_samples_per_second': 54.023,
2022-04-19 15:47:49 [INFO]     'eval_steps_per_second': 7.023
2022-04-19 15:47:49 [INFO] }
2022-04-19 15:47:49 [INFO] metric: 0.7699999809265137
2022-04-19 15:47:49 [INFO] Throughput: 54.023 samples/sec
2022-04-19 15:47:49 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:47:49 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): QuantizedLinear(in_features=3072, out_features=768, scale=3.1511282920837402, zero_point=242, qscheme=torch.per_channel_affine)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:47:52 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:47:52 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:52 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:47:52 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:52 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:47:52 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:47:52 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:47:52 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:47:52 [INFO] |     input_tensor    |   1   |  1   |  0   |
2022-04-19 15:47:52 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:47:52 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:52 [INFO] Pass quantize model elapsed time: 3103.91 ms
2022-04-19 15:47:52 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:47:52,506 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:47:52,506 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:47:52,506 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.98it/s] 31%|███       | 4/13 [00:00<00:00, 10.38it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.70it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.58it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.18it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.48it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.51it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.44it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.82it/s]100%|██████████| 13/13 [00:01<00:00,  8.18it/s]
2022-04-19 15:47:54 [INFO] {
2022-04-19 15:47:54 [INFO]     'eval_loss': 1.09688401222229,
2022-04-19 15:47:54 [INFO]     'eval_accuracy': 0.7599999904632568,
2022-04-19 15:47:54 [INFO]     'eval_runtime': 1.725,
2022-04-19 15:47:54 [INFO]     'eval_samples_per_second': 57.971,
2022-04-19 15:47:54 [INFO]     'eval_steps_per_second': 7.536
2022-04-19 15:47:54 [INFO] }
2022-04-19 15:47:54 [INFO] metric: 0.7599999904632568
2022-04-19 15:47:54 [INFO] Throughput: 57.971 samples/sec
2022-04-19 15:47:54 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:47:54 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.04663578048348427, zero_point=119, qscheme=torch.per_channel_affine)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:47:56 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:47:56 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:56 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:47:56 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:56 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:47:56 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:47:56 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:47:56 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:47:56 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:47:56 [INFO] +---------------------+-------+------+------+
2022-04-19 15:47:56 [INFO] Pass quantize model elapsed time: 2720.9 ms
2022-04-19 15:47:56 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:47:56,960 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:47:56,960 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:47:56,960 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.58it/s] 31%|███       | 4/13 [00:00<00:00, 10.34it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.50it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.38it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.01it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.39it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.43it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.37it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.81it/s]100%|██████████| 13/13 [00:01<00:00,  8.08it/s]
2022-04-19 15:47:58 [INFO] {
2022-04-19 15:47:58 [INFO]     'eval_loss': 1.1599838733673096,
2022-04-19 15:47:58 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:47:58 [INFO]     'eval_runtime': 1.7472,
2022-04-19 15:47:58 [INFO]     'eval_samples_per_second': 57.234,
2022-04-19 15:47:58 [INFO]     'eval_steps_per_second': 7.44
2022-04-19 15:47:58 [INFO] }
2022-04-19 15:47:58 [INFO] metric: 0.7699999809265137
2022-04-19 15:47:58 [INFO] Throughput: 57.234 samples/sec
2022-04-19 15:47:58 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:47:58 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.05077357217669487, zero_point=137, qscheme=torch.per_channel_affine)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:48:01 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:48:01 [INFO] +---------------------+-------+------+------+
2022-04-19 15:48:01 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:48:01 [INFO] +---------------------+-------+------+------+
2022-04-19 15:48:01 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:48:01 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:48:01 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:48:01 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:48:01 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:48:01 [INFO] +---------------------+-------+------+------+
2022-04-19 15:48:01 [INFO] Pass quantize model elapsed time: 2746.71 ms
2022-04-19 15:48:01 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:48:01,461 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:48:01,461 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:48:01,461 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.95it/s] 31%|███       | 4/13 [00:00<00:00, 10.48it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.62it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.41it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.05it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.42it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.47it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.39it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.84it/s]100%|██████████| 13/13 [00:01<00:00,  8.13it/s]
2022-04-19 15:48:03 [INFO] {
2022-04-19 15:48:03 [INFO]     'eval_loss': 1.1619083881378174,
2022-04-19 15:48:03 [INFO]     'eval_accuracy': 0.7599999904632568,
2022-04-19 15:48:03 [INFO]     'eval_runtime': 1.7361,
2022-04-19 15:48:03 [INFO]     'eval_samples_per_second': 57.602,
2022-04-19 15:48:03 [INFO]     'eval_steps_per_second': 7.488
2022-04-19 15:48:03 [INFO] }
2022-04-19 15:48:03 [INFO] metric: 0.7599999904632568
2022-04-19 15:48:03 [INFO] Throughput: 57.602 samples/sec
2022-04-19 15:48:03 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:48:03 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): QuantizedLinear(in_features=768, out_features=768, scale=0.042115792632102966, zero_point=133, qscheme=torch.per_channel_affine)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:48:06 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:48:06 [INFO] +---------------------+-------+------+------+
2022-04-19 15:48:06 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:48:06 [INFO] +---------------------+-------+------+------+
2022-04-19 15:48:06 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:48:06 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:48:06 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:48:06 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:48:06 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:48:06 [INFO] +---------------------+-------+------+------+
2022-04-19 15:48:06 [INFO] Pass quantize model elapsed time: 2848.28 ms
2022-04-19 15:48:06 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:48:06,053 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:48:06,053 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:48:06,053 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.88it/s] 31%|███       | 4/13 [00:00<00:00, 10.45it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.64it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.37it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.03it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.39it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.38it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.32it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.79it/s]100%|██████████| 13/13 [00:01<00:00,  8.08it/s]
2022-04-19 15:48:07 [INFO] {
2022-04-19 15:48:07 [INFO]     'eval_loss': 1.1600500345230103,
2022-04-19 15:48:07 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:48:07 [INFO]     'eval_runtime': 1.7452,
2022-04-19 15:48:07 [INFO]     'eval_samples_per_second': 57.301,
2022-04-19 15:48:07 [INFO]     'eval_steps_per_second': 7.449
2022-04-19 15:48:07 [INFO] }
2022-04-19 15:48:07 [INFO] metric: 0.7699999809265137
2022-04-19 15:48:07 [INFO] Throughput: 57.301 samples/sec
2022-04-19 15:48:07 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:48:08 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): QuantizedLinear(in_features=768, out_features=768, scale=0.02681095153093338, zero_point=136, qscheme=torch.per_channel_affine)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:48:10 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:48:10 [INFO] +---------------------+-------+------+------+
2022-04-19 15:48:10 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:48:10 [INFO] +---------------------+-------+------+------+
2022-04-19 15:48:10 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:48:10 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:48:10 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:48:10 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:48:10 [INFO] |     input_tensor    |   1   |  1   |  0   |
2022-04-19 15:48:10 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:48:10 [INFO] +---------------------+-------+------+------+
2022-04-19 15:48:10 [INFO] Pass quantize model elapsed time: 2871.63 ms
2022-04-19 15:48:10 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:48:10,677 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:48:10,677 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:48:10,677 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.00it/s] 31%|███       | 4/13 [00:00<00:00, 10.34it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.61it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.39it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.03it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.39it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.43it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.35it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.79it/s]100%|██████████| 13/13 [00:01<00:00,  8.08it/s]
2022-04-19 15:48:12 [INFO] {
2022-04-19 15:48:12 [INFO]     'eval_loss': 1.1618109941482544,
2022-04-19 15:48:12 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:48:12 [INFO]     'eval_runtime': 1.7442,
2022-04-19 15:48:12 [INFO]     'eval_samples_per_second': 57.334,
2022-04-19 15:48:12 [INFO]     'eval_steps_per_second': 7.453
2022-04-19 15:48:12 [INFO] }
2022-04-19 15:48:12 [INFO] metric: 0.7699999809265137
2022-04-19 15:48:12 [INFO] Throughput: 57.334 samples/sec
2022-04-19 15:48:12 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:48:12 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): QuantizedLinear(in_features=768, out_features=3072, scale=0.07884379476308823, zero_point=170, qscheme=torch.per_channel_affine)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:48:15 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:48:15 [INFO] +---------------------+-------+------+------+
2022-04-19 15:48:15 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:48:15 [INFO] +---------------------+-------+------+------+
2022-04-19 15:48:15 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:48:15 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:48:15 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:48:15 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:48:15 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:48:15 [INFO] +---------------------+-------+------+------+
2022-04-19 15:48:15 [INFO] Pass quantize model elapsed time: 2995.7 ms
2022-04-19 15:48:15 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:48:15,423 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:48:15,424 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:48:15,424 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.58it/s] 31%|███       | 4/13 [00:00<00:00, 10.45it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.74it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.53it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.18it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.53it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.58it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.49it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.92it/s]100%|██████████| 13/13 [00:01<00:00,  8.23it/s]
2022-04-19 15:48:17 [INFO] {
2022-04-19 15:48:17 [INFO]     'eval_loss': 1.1887409687042236,
2022-04-19 15:48:17 [INFO]     'eval_accuracy': 0.7599999904632568,
2022-04-19 15:48:17 [INFO]     'eval_runtime': 1.7152,
2022-04-19 15:48:17 [INFO]     'eval_samples_per_second': 58.301,
2022-04-19 15:48:17 [INFO]     'eval_steps_per_second': 7.579
2022-04-19 15:48:17 [INFO] }
2022-04-19 15:48:17 [INFO] metric: 0.7599999904632568
2022-04-19 15:48:17 [INFO] Throughput: 58.301 samples/sec
2022-04-19 15:48:17 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:48:17 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): QuantizedLinear(in_features=3072, out_features=768, scale=0.16209007799625397, zero_point=181, qscheme=torch.per_channel_affine)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:48:20 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:48:20 [INFO] +---------------------+-------+------+------+
2022-04-19 15:48:20 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:48:20 [INFO] +---------------------+-------+------+------+
2022-04-19 15:48:20 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:48:20 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:48:20 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:48:20 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:48:20 [INFO] |     input_tensor    |   1   |  1   |  0   |
2022-04-19 15:48:20 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:48:20 [INFO] +---------------------+-------+------+------+
2022-04-19 15:48:20 [INFO] Pass quantize model elapsed time: 3448.27 ms
2022-04-19 15:48:20 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:48:20,594 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:48:20,594 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:48:20,594 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.64it/s] 31%|███       | 4/13 [00:00<00:00, 10.19it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.58it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.46it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.07it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.35it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.42it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.32it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.74it/s]100%|██████████| 13/13 [00:01<00:00,  8.06it/s]
2022-04-19 15:48:22 [INFO] {
2022-04-19 15:48:22 [INFO]     'eval_loss': 1.1626330614089966,
2022-04-19 15:48:22 [INFO]     'eval_accuracy': 0.7599999904632568,
2022-04-19 15:48:22 [INFO]     'eval_runtime': 1.7502,
2022-04-19 15:48:22 [INFO]     'eval_samples_per_second': 57.137,
2022-04-19 15:48:22 [INFO]     'eval_steps_per_second': 7.428
2022-04-19 15:48:22 [INFO] }
2022-04-19 15:48:22 [INFO] metric: 0.7599999904632568
2022-04-19 15:48:22 [INFO] Throughput: 57.137 samples/sec
2022-04-19 15:48:22 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:48:22 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): QuantizedLinear(in_features=768, out_features=768, scale=0.08549576997756958, zero_point=129, qscheme=torch.per_channel_affine)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): Linear(in_features=768, out_features=1, bias=True)
    )
  )
)2022-04-19 15:48:24 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:48:24 [INFO] +---------------------+-------+------+------+
2022-04-19 15:48:24 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:48:24 [INFO] +---------------------+-------+------+------+
2022-04-19 15:48:24 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:48:24 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:48:24 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:48:24 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:48:24 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:48:24 [INFO] +---------------------+-------+------+------+
2022-04-19 15:48:24 [INFO] Pass quantize model elapsed time: 2646.2 ms
2022-04-19 15:48:24 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:48:24,999 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:48:24,999 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:48:24,999 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.79it/s] 31%|███       | 4/13 [00:00<00:00, 10.55it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.63it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.50it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.13it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.44it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.49it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.41it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.82it/s]100%|██████████| 13/13 [00:01<00:00,  8.14it/s]
2022-04-19 15:48:26 [INFO] {
2022-04-19 15:48:26 [INFO]     'eval_loss': 1.160992980003357,
2022-04-19 15:48:26 [INFO]     'eval_accuracy': 0.7599999904632568,
2022-04-19 15:48:26 [INFO]     'eval_runtime': 1.733,
2022-04-19 15:48:26 [INFO]     'eval_samples_per_second': 57.705,
2022-04-19 15:48:26 [INFO]     'eval_steps_per_second': 7.502
2022-04-19 15:48:26 [INFO] }
2022-04-19 15:48:26 [INFO] metric: 0.7599999904632568
2022-04-19 15:48:26 [INFO] Throughput: 57.705 samples/sec
2022-04-19 15:48:26 [INFO] Fx trace of the entire model failed, We will conduct auto quantization
2022-04-19 15:48:26 [WARNING] Please note that calibration sampling size 100 isn't divisible exactly by batch size 8. So the real sampling size is 104.
=========== asym kl
PyTorchFXModel(
  (_model): BertForMultipleChoice(
    (bert): BertModel(
      (embeddings): BertEmbeddings(
        (word_embeddings): GraphModule(
          (module): Embedding(30522, 768, padding_idx=0)
        )
        (position_embeddings): GraphModule(
          (module): Embedding(512, 768)
        )
        (token_type_embeddings): GraphModule(
          (module): Embedding(2, 768)
        )
        (LayerNorm): GraphModule(
          (module): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
      (encoder): BertEncoder(
        (layer): ModuleList(
          (0): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (1): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (2): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (3): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (4): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (5): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (6): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (7): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (8): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (9): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (10): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
          (11): BertLayer(
            (attention): BertAttention(
              (self): BertSelfAttention(
                (query): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (key): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (value): GraphModule(
                  (module): Linear(in_features=768, out_features=768, bias=True)
                )
                (dropout): Dropout(p=0.1, inplace=False)
              )
              (output): GraphModule(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.1, inplace=False)
                (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
              )
            )
            (intermediate): GraphModule(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
            )
            (output): GraphModule(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.1, inplace=False)
              (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            )
          )
        )
      )
      (pooler): GraphModule(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (activation): Tanh()
      )
    )
    (dropout): Dropout(p=0.1, inplace=False)
    (classifier): GraphModule(
      (module): QuantizedLinear(in_features=768, out_features=1, scale=0.11445620656013489, zero_point=126, qscheme=torch.per_channel_affine)
    )
  )
)2022-04-19 15:48:29 [INFO] |*********Mixed Precision Statistics********|
2022-04-19 15:48:29 [INFO] +---------------------+-------+------+------+
2022-04-19 15:48:29 [INFO] |       Op Type       | Total | INT8 | FP32 |
2022-04-19 15:48:29 [INFO] +---------------------+-------+------+------+
2022-04-19 15:48:29 [INFO] |      Embedding      |   3   |  0   |  3   |
2022-04-19 15:48:29 [INFO] |      LayerNorm      |   25  |  0   |  25  |
2022-04-19 15:48:29 [INFO] |        Linear       |   74  |  1   |  73  |
2022-04-19 15:48:29 [INFO] | quantize_per_tensor |   1   |  1   |  0   |
2022-04-19 15:48:29 [INFO] |      dequantize     |   1   |  1   |  0   |
2022-04-19 15:48:29 [INFO] +---------------------+-------+------+------+
2022-04-19 15:48:29 [INFO] Pass quantize model elapsed time: 3042.78 ms
2022-04-19 15:48:29 [INFO] The following columns in the evaluation set  don't have a corresponding argument in `BertForMultipleChoice.forward` and have been ignored: gold-source, sent2, ending0, ending3, startphrase, sent1, fold-ind, ending2, ending1, video-id.
[INFO|trainer.py:2416] 2022-04-19 15:48:29,782 >> ***** Running Evaluation *****
[INFO|trainer.py:2418] 2022-04-19 15:48:29,783 >>   Num examples = 100
[INFO|trainer.py:2421] 2022-04-19 15:48:29,783 >>   Batch size = 8

  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.53it/s] 31%|███       | 4/13 [00:00<00:00, 10.13it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.55it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.41it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.03it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.39it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.43it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.36it/s] 92%|█████████▏| 12/13 [00:01<00:00,  6.83it/s]100%|██████████| 13/13 [00:01<00:00,  8.09it/s]
2022-04-19 15:48:31 [INFO] {
2022-04-19 15:48:31 [INFO]     'eval_loss': 1.1626332998275757,
2022-04-19 15:48:31 [INFO]     'eval_accuracy': 0.7699999809265137,
2022-04-19 15:48:31 [INFO]     'eval_runtime': 1.7449,
2022-04-19 15:48:31 [INFO]     'eval_samples_per_second': 57.308,
2022-04-19 15:48:31 [INFO]     'eval_steps_per_second': 7.45
2022-04-19 15:48:31 [INFO] }
2022-04-19 15:48:31 [INFO] metric: 0.7699999809265137
2022-04-19 15:48:31 [INFO] Throughput: 57.308 samples/sec
2022-04-19 15:48:31 [ERROR] Specified timeout or max trials is reached! Not found any quantized model which meet accuracy goal. Exit.
[INFO|configuration_utils.py:441] 2022-04-19 15:48:31,533 >> Configuration saved in ./tmp/test/config.json
Traceback (most recent call last):
  File "run_swag.py", line 528, in <module>
    main()
  File "run_swag.py", line 499, in main
    model = trainer.quantize(quant_config=quantization_config)
  File "/home2/xinhe/nlp-toolkit/nlp_toolkit/optimization/trainer.py", line 282, in quantize
    return self._inc_quantize(quant_config=quant_config, provider=provider)
  File "/home2/xinhe/nlp-toolkit/nlp_toolkit/optimization/trainer.py", line 257, in _inc_quantize
    self._save_inc_int8(self.opt_model, self.args.output_dir)
  File "/home2/xinhe/nlp-toolkit/nlp_toolkit/optimization/trainer.py", line 292, in _save_inc_int8
    torch.save(opt_model.quantized_state_dict(), weights_file)
AttributeError: 'NoneType' object has no attribute 'quantized_state_dict'
